function ArrayFill(t,e){for(var r=0;r<t.length;r++)t[r]=e;return t}function ObjectKeys(t){var e=[];for(var r in t)t.hasOwnProperty(r)&&e.push(r);return e}function HexToStr(t){return t.match(/.{1,2}/g).map((function(t){return String.fromCharCode(parseInt(t,16))})).join("")}function StrToHex(t){return t.split("").map((function(t){var e="0"+t.charCodeAt(0).toString(16);return e.substr(e.length-2)})).join("")}function HexToArray(t){return t.match(/.{1,2}/g).map((function(t){return parseInt(t,16)}))}function ArrayToHex(t){return t.map((function(t){var e="0"+((t+256)%256).toString(16);return e.substr(e.length-2)})).join("")}function StrToArray(t){return HexToArray(StrToHex(t))}function ArrayToStr(t){return HexToStr(ArrayToHex(t))}function StringRepeat(t,e){if(e<1)return"";for(var r="";e>1;)1&e&&(r+=t),e>>=1,t+=t;return r+t}function hex2bin(t){for(var e="",r=0;r<t.length/2;r++)e+=String.fromCharCode(parseInt(t.substr(2*r,2),16));return e}if(function(t,e){"use strict";"function"==typeof define&&define.amd?define(e):"object"==typeof exports?module.exports=e():t.returnExports=e()}(this,(function(){var t,e,r=Array,o=r.prototype,n=Object,i=n.prototype,s=Function,a=s.prototype,u=String,h=u.prototype,p=Number,l=p.prototype,f=o.slice,c=o.splice,d=o.push,m=o.unshift,g=o.concat,v=o.join,y=a.call,w=a.apply,b=Math.max,E=Math.min,S=i.toString,T="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag,x=Function.prototype.toString,O=/^\s*class /,B=function(t){try{var e=x.call(t).replace(/\/\/.*\n/g,"").replace(/\/\*[.\s\S]*\*\//g,"").replace(/\n/gm," ").replace(/ {2}/g," ");return O.test(e)}catch(t){return!1}},A=function(t){if(!t)return!1;if("function"!=typeof t&&"object"!=typeof t)return!1;if(T)return function(t){try{return!B(t)&&(x.call(t),!0)}catch(t){return!1}}(t);if(B(t))return!1;var e=S.call(t);return"[object Function]"===e||"[object GeneratorFunction]"===e},D=RegExp.prototype.exec;t=function(t){return"object"==typeof t&&(T?function(t){try{return D.call(t),!0}catch(t){return!1}}(t):"[object RegExp]"===S.call(t))};var _=String.prototype.valueOf;e=function(t){return"string"==typeof t||"object"==typeof t&&(T?function(t){try{return _.call(t),!0}catch(t){return!1}}(t):"[object String]"===S.call(t))};var C,M,P=n.defineProperty&&function(){try{var t={};for(var e in n.defineProperty(t,"x",{enumerable:!1,value:t}),t)return!1;return t.x===t}catch(t){return!1}}(),R=(C=i.hasOwnProperty,M=P?function(t,e,r,o){!o&&e in t||n.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:!0,value:r})}:function(t,e,r,o){!o&&e in t||(t[e]=r)},function(t,e,r){for(var o in e)C.call(e,o)&&M(t,o,e[o],r)}),I=function(t){var e=typeof t;return null===t||"object"!==e&&"function"!==e},N=p.isNaN||function(t){return t!=t},G=function(t){var e=+t;return N(e)?e=0:0!==e&&e!==1/0&&e!==-1/0&&(e=(e>0||-1)*Math.floor(Math.abs(e))),e},k=function(t){var e,r,o;if(I(t))return t;if(r=t.valueOf,A(r)&&(e=r.call(t),I(e)))return e;if(o=t.toString,A(o)&&(e=o.call(t),I(e)))return e;throw new TypeError},F=function(t){if(null==t)throw new TypeError("can't convert "+t+" to object");return n(t)},H=function(t){return t>>>0},U=function(){};R(a,{bind:function(t){var e=this;if(!A(e))throw new TypeError("Function.prototype.bind called on incompatible "+e);for(var r,o=f.call(arguments,1),i=b(0,e.length-o.length),a=[],u=0;u<i;u++)d.call(a,"$"+u);return r=s("binder","return function ("+v.call(a,",")+"){ return binder.apply(this, arguments); }")((function(){if(this instanceof r){var i=w.call(e,this,g.call(o,f.call(arguments)));return n(i)===i?i:this}return w.call(e,t,g.call(o,f.call(arguments)))})),e.prototype&&(U.prototype=e.prototype,r.prototype=new U,U.prototype=null),r}});var j=y.bind(i.hasOwnProperty),z=y.bind(i.toString),q=y.bind(f),L=w.bind(f);if("object"==typeof document&&document&&document.documentElement)try{q(document.documentElement.childNodes)}catch(t){var Z=q,V=L;q=function(t){for(var e=[],r=t.length;r-- >0;)e[r]=t[r];return V(e,Z(arguments,1))},L=function(t,e){return V(q(t),e)}}var J=y.bind(h.slice),Y=y.bind(h.split),Q=y.bind(h.indexOf),$=y.bind(d),X=y.bind(i.propertyIsEnumerable),W=y.bind(o.sort),K=r.isArray||function(t){return"[object Array]"===z(t)},tt=1!==[].unshift(0);R(o,{unshift:function(){return m.apply(this,arguments),this.length}},tt),R(r,{isArray:K});var et=n("a"),rt="a"!==et[0]||!(0 in et),ot=function(t){var e=!0,r=!0,o=!1;if(t)try{t.call("foo",(function(t,r,o){"object"!=typeof o&&(e=!1)})),t.call([1],(function(){"use strict";r="string"==typeof this}),"x")}catch(t){o=!0}return!!t&&!o&&e&&r};R(o,{forEach:function(t){var r,o=F(this),n=rt&&e(this)?Y(this,""):o,i=-1,s=H(n.length);if(arguments.length>1&&(r=arguments[1]),!A(t))throw new TypeError("Array.prototype.forEach callback must be a function");for(;++i<s;)i in n&&(void 0===r?t(n[i],i,o):t.call(r,n[i],i,o))}},!ot(o.forEach)),R(o,{map:function(t){var o,n=F(this),i=rt&&e(this)?Y(this,""):n,s=H(i.length),a=r(s);if(arguments.length>1&&(o=arguments[1]),!A(t))throw new TypeError("Array.prototype.map callback must be a function");for(var u=0;u<s;u++)u in i&&(a[u]=void 0===o?t(i[u],u,n):t.call(o,i[u],u,n));return a}},!ot(o.map)),R(o,{filter:function(t){var r,o,n=F(this),i=rt&&e(this)?Y(this,""):n,s=H(i.length),a=[];if(arguments.length>1&&(o=arguments[1]),!A(t))throw new TypeError("Array.prototype.filter callback must be a function");for(var u=0;u<s;u++)u in i&&(r=i[u],(void 0===o?t(r,u,n):t.call(o,r,u,n))&&$(a,r));return a}},!ot(o.filter)),R(o,{every:function(t){var r,o=F(this),n=rt&&e(this)?Y(this,""):o,i=H(n.length);if(arguments.length>1&&(r=arguments[1]),!A(t))throw new TypeError("Array.prototype.every callback must be a function");for(var s=0;s<i;s++)if(s in n&&!(void 0===r?t(n[s],s,o):t.call(r,n[s],s,o)))return!1;return!0}},!ot(o.every)),R(o,{some:function(t){var r,o=F(this),n=rt&&e(this)?Y(this,""):o,i=H(n.length);if(arguments.length>1&&(r=arguments[1]),!A(t))throw new TypeError("Array.prototype.some callback must be a function");for(var s=0;s<i;s++)if(s in n&&(void 0===r?t(n[s],s,o):t.call(r,n[s],s,o)))return!0;return!1}},!ot(o.some));var nt=!1;o.reduce&&(nt="object"==typeof o.reduce.call("es5",(function(t,e,r,o){return o}))),R(o,{reduce:function(t){var r=F(this),o=rt&&e(this)?Y(this,""):r,n=H(o.length);if(!A(t))throw new TypeError("Array.prototype.reduce callback must be a function");if(0===n&&1===arguments.length)throw new TypeError("reduce of empty array with no initial value");var i,s=0;if(arguments.length>=2)i=arguments[1];else for(;;){if(s in o){i=o[s++];break}if(++s>=n)throw new TypeError("reduce of empty array with no initial value")}for(;s<n;s++)s in o&&(i=t(i,o[s],s,r));return i}},!nt);var it=!1;o.reduceRight&&(it="object"==typeof o.reduceRight.call("es5",(function(t,e,r,o){return o}))),R(o,{reduceRight:function(t){var r,o=F(this),n=rt&&e(this)?Y(this,""):o,i=H(n.length);if(!A(t))throw new TypeError("Array.prototype.reduceRight callback must be a function");if(0===i&&1===arguments.length)throw new TypeError("reduceRight of empty array with no initial value");var s=i-1;if(arguments.length>=2)r=arguments[1];else for(;;){if(s in n){r=n[s--];break}if(--s<0)throw new TypeError("reduceRight of empty array with no initial value")}if(s<0)return r;do{s in n&&(r=t(r,n[s],s,o))}while(s--);return r}},!it);var st=o.indexOf&&-1!==[0,1].indexOf(1,2);R(o,{indexOf:function(t){var r=rt&&e(this)?Y(this,""):F(this),o=H(r.length);if(0===o)return-1;var n=0;for(arguments.length>1&&(n=G(arguments[1])),n=n>=0?n:b(0,o+n);n<o;n++)if(n in r&&r[n]===t)return n;return-1}},st);var at=o.lastIndexOf&&-1!==[0,1].lastIndexOf(0,-3);R(o,{lastIndexOf:function(t){var r=rt&&e(this)?Y(this,""):F(this),o=H(r.length);if(0===o)return-1;var n=o-1;for(arguments.length>1&&(n=E(n,G(arguments[1]))),n=n>=0?n:o-Math.abs(n);n>=0;n--)if(n in r&&t===r[n])return n;return-1}},at);var ut,ht,pt=(ht=(ut=[1,2]).splice(),2===ut.length&&K(ht)&&0===ht.length);R(o,{splice:function(t,e){return 0===arguments.length?[]:c.apply(this,arguments)}},!pt);var lt,ft=(lt={},o.splice.call(lt,0,0,1),1===lt.length);R(o,{splice:function(t,e){if(0===arguments.length)return[];var r=arguments;return this.length=b(G(this.length),0),arguments.length>0&&"number"!=typeof e&&((r=q(arguments)).length<2?$(r,this.length-t):r[1]=G(e)),c.apply(this,r)}},!ft);var ct,dt=((ct=new r(1e5))[8]="x",ct.splice(1,1),7===ct.indexOf("x")),mt=function(){var t=[];return t[256]="a",t.splice(257,0,"b"),"a"===t[256]}();R(o,{splice:function(t,e){for(var r,o=F(this),n=[],i=H(o.length),s=G(t),a=s<0?b(i+s,0):E(s,i),h=E(b(G(e),0),i-a),p=0;p<h;)r=u(a+p),j(o,r)&&(n[p]=o[r]),p+=1;var l,f=q(arguments,2),c=f.length;if(c<h){p=a;for(var d=i-h;p<d;)r=u(p+h),l=u(p+c),j(o,r)?o[l]=o[r]:delete o[l],p+=1;p=i;for(var m=i-h+c;p>m;)delete o[p-1],p-=1}else if(c>h)for(p=i-h;p>a;)r=u(p+h-1),l=u(p+c-1),j(o,r)?o[l]=o[r]:delete o[l],p-=1;p=a;for(var g=0;g<f.length;++g)o[p]=f[g],p+=1;return o.length=i-h+c,n}},!dt||!mt);var gt,vt=o.join;try{gt="1,2,3"!==Array.prototype.join.call("123",",")}catch(t){gt=!0}gt&&R(o,{join:function(t){var r=void 0===t?",":t;return vt.call(e(this)?Y(this,""):this,r)}},gt);var yt="1,2"!==[1,2].join(void 0);yt&&R(o,{join:function(t){var e=void 0===t?",":t;return vt.call(this,e)}},yt);var wt=function(t){for(var e=F(this),r=H(e.length),o=0;o<arguments.length;)e[r+o]=arguments[o],o+=1;return e.length=r+o,r+o},bt=function(){var t={};return 1!==Array.prototype.push.call(t,void 0)||1!==t.length||void 0!==t[0]||!j(t,0)}();R(o,{push:function(t){return K(this)?d.apply(this,arguments):wt.apply(this,arguments)}},bt);var Et=function(){var t=[];return 1!==t.push(void 0)||1!==t.length||void 0!==t[0]||!j(t,0)}();R(o,{push:wt},Et),R(o,{slice:function(t,r){var o=e(this)?Y(this,""):this;return L(o,arguments)}},rt);var St=function(){try{return[1,2].sort(null),[1,2].sort({}),!0}catch(t){}return!1}(),Tt=function(){try{return[1,2].sort(/a/),!1}catch(t){}return!0}(),xt=function(){try{return[1,2].sort(void 0),!0}catch(t){}return!1}();R(o,{sort:function(t){if(void 0===t)return W(this);if(!A(t))throw new TypeError("Array.prototype.sort callback must be a function");return W(this,t)}},St||!xt||!Tt);var Ot=!X({toString:null},"toString"),Bt=X((function(){}),"prototype"),At=!j("x","0"),Dt=function(t){var e=t.constructor;return e&&e.prototype===t},_t={$window:!0,$console:!0,$parent:!0,$self:!0,$frame:!0,$frames:!0,$frameElement:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$external:!0,$width:!0,$height:!0,$top:!0,$localStorage:!0},Ct=function(){if("undefined"==typeof window)return!1;for(var t in window)try{!_t["$"+t]&&j(window,t)&&null!==window[t]&&"object"==typeof window[t]&&Dt(window[t])}catch(t){return!0}return!1}(),Mt=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],Pt=Mt.length,Rt=function(t){return"[object Arguments]"===z(t)},It=Rt(arguments)?Rt:function(t){return null!==t&&"object"==typeof t&&"number"==typeof t.length&&t.length>=0&&!K(t)&&A(t.callee)};R(n,{keys:function(t){var r=A(t),o=It(t),n=null!==t&&"object"==typeof t,i=n&&e(t);if(!n&&!r&&!o)throw new TypeError("Object.keys called on a non-object");var s=[],a=Bt&&r;if(i&&At||o)for(var h=0;h<t.length;++h)$(s,u(h));if(!o)for(var p in t)a&&"prototype"===p||!j(t,p)||$(s,u(p));if(Ot)for(var l=function(t){if("undefined"==typeof window||!Ct)return Dt(t);try{return Dt(t)}catch(t){return!1}}(t),f=0;f<Pt;f++){var c=Mt[f];l&&"constructor"===c||!j(t,c)||$(s,c)}return s}});var Nt=n.keys&&function(){return 2===n.keys(arguments).length}(1,2),Gt=n.keys&&function(){var t=n.keys(arguments);return 1!==arguments.length||1!==t.length||1!==t[0]}(1),kt=n.keys;R(n,{keys:function(t){return It(t)?kt(q(t)):kt(t)}},!Nt||Gt);var Ft,Ht,Ut=0!==new Date(-0xc782b5b342b24).getUTCMonth(),jt=new Date(-0x55d318d56a724),zt=new Date(14496624e5),qt="Mon, 01 Jan -45875 11:59:59 GMT"!==jt.toUTCString();jt.getTimezoneOffset()<-720?(Ft="Tue Jan 02 -45875"!==jt.toDateString(),Ht=!/^Thu Dec 10 2015 \d\d:\d\d:\d\d GMT[-+]\d\d\d\d(?: |$)/.test(String(zt))):(Ft="Mon Jan 01 -45875"!==jt.toDateString(),Ht=!/^Wed Dec 09 2015 \d\d:\d\d:\d\d GMT[-+]\d\d\d\d(?: |$)/.test(String(zt)));var Lt=y.bind(Date.prototype.getFullYear),Zt=y.bind(Date.prototype.getMonth),Vt=y.bind(Date.prototype.getDate),Jt=y.bind(Date.prototype.getUTCFullYear),Yt=y.bind(Date.prototype.getUTCMonth),Qt=y.bind(Date.prototype.getUTCDate),$t=y.bind(Date.prototype.getUTCDay),Xt=y.bind(Date.prototype.getUTCHours),Wt=y.bind(Date.prototype.getUTCMinutes),Kt=y.bind(Date.prototype.getUTCSeconds),te=y.bind(Date.prototype.getUTCMilliseconds),ee=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],re=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],oe=function(t,e){return Vt(new Date(e,t,0))};R(Date.prototype,{getFullYear:function(){if(!(this&&this instanceof Date))throw new TypeError("this is not a Date object.");var t=Lt(this);return t<0&&Zt(this)>11?t+1:t},getMonth:function(){if(!(this&&this instanceof Date))throw new TypeError("this is not a Date object.");var t=Lt(this),e=Zt(this);return t<0&&e>11?0:e},getDate:function(){if(!(this&&this instanceof Date))throw new TypeError("this is not a Date object.");var t=Lt(this),e=Zt(this),r=Vt(this);return t<0&&e>11?12===e?r:oe(0,t+1)-r+1:r},getUTCFullYear:function(){if(!(this&&this instanceof Date))throw new TypeError("this is not a Date object.");var t=Jt(this);return t<0&&Yt(this)>11?t+1:t},getUTCMonth:function(){if(!(this&&this instanceof Date))throw new TypeError("this is not a Date object.");var t=Jt(this),e=Yt(this);return t<0&&e>11?0:e},getUTCDate:function(){if(!(this&&this instanceof Date))throw new TypeError("this is not a Date object.");var t=Jt(this),e=Yt(this),r=Qt(this);return t<0&&e>11?12===e?r:oe(0,t+1)-r+1:r}},Ut),R(Date.prototype,{toUTCString:function(){if(!(this&&this instanceof Date))throw new TypeError("this is not a Date object.");var t=$t(this),e=Qt(this),r=Yt(this),o=Jt(this),n=Xt(this),i=Wt(this),s=Kt(this);return ee[t]+", "+(e<10?"0"+e:e)+" "+re[r]+" "+o+" "+(n<10?"0"+n:n)+":"+(i<10?"0"+i:i)+":"+(s<10?"0"+s:s)+" GMT"}},Ut||qt),R(Date.prototype,{toDateString:function(){if(!(this&&this instanceof Date))throw new TypeError("this is not a Date object.");var t=this.getDay(),e=this.getDate(),r=this.getMonth(),o=this.getFullYear();return ee[t]+" "+re[r]+" "+(e<10?"0"+e:e)+" "+o}},Ut||Ft),(Ut||Ht)&&(Date.prototype.toString=function(){if(!(this&&this instanceof Date))throw new TypeError("this is not a Date object.");var t=this.getDay(),e=this.getDate(),r=this.getMonth(),o=this.getFullYear(),n=this.getHours(),i=this.getMinutes(),s=this.getSeconds(),a=this.getTimezoneOffset(),u=Math.floor(Math.abs(a)/60),h=Math.floor(Math.abs(a)%60);return ee[t]+" "+re[r]+" "+(e<10?"0"+e:e)+" "+o+" "+(n<10?"0"+n:n)+":"+(i<10?"0"+i:i)+":"+(s<10?"0"+s:s)+" GMT"+(a>0?"-":"+")+(u<10?"0"+u:u)+(h<10?"0"+h:h)},P&&n.defineProperty(Date.prototype,"toString",{configurable:!0,enumerable:!1,writable:!0}));var ne=-621987552e5,ie="-000001",se=Date.prototype.toISOString&&-1===new Date(ne).toISOString().indexOf(ie),ae=Date.prototype.toISOString&&"1969-12-31T23:59:59.999Z"!==new Date(-1).toISOString(),ue=y.bind(Date.prototype.getTime);R(Date.prototype,{toISOString:function(){if(!isFinite(this)||!isFinite(ue(this)))throw new RangeError("Date.prototype.toISOString called on non-finite value.");var t=Jt(this),e=Yt(this);t+=Math.floor(e/12);var r=[(e=(e%12+12)%12)+1,Qt(this),Xt(this),Wt(this),Kt(this)];t=(t<0?"-":t>9999?"+":"")+J("00000"+Math.abs(t),0<=t&&t<=9999?-4:-6);for(var o=0;o<r.length;++o)r[o]=J("00"+r[o],-2);return t+"-"+q(r,0,2).join("-")+"T"+q(r,2).join(":")+"."+J("000"+te(this),-3)+"Z"}},se||ae),function(){try{return Date.prototype.toJSON&&null===new Date(NaN).toJSON()&&-1!==new Date(ne).toJSON().indexOf(ie)&&Date.prototype.toJSON.call({toISOString:function(){return!0}})}catch(t){return!1}}()||(Date.prototype.toJSON=function(t){var e=n(this),r=k(e);if("number"==typeof r&&!isFinite(r))return null;var o=e.toISOString;if(!A(o))throw new TypeError("toISOString property is not callable");return o.call(e)});var he=1e15===Date.parse("+033658-09-27T01:46:40.000Z"),pe=!isNaN(Date.parse("2012-04-04T24:00:00.500Z"))||!isNaN(Date.parse("2012-11-31T23:59:59.000Z"))||!isNaN(Date.parse("2012-12-31T23:59:60.000Z"));if(isNaN(Date.parse("2000-01-01T00:00:00.000Z"))||pe||!he){var le=Math.pow(2,31)-1,fe=N(new Date(1970,0,1,0,0,0,le+1).getTime());Date=function(t){var e=function(r,o,n,i,s,a,h){var p,l=arguments.length;if(this instanceof t){var f=a,c=h;if(fe&&l>=7&&h>le){var d=Math.floor(h/le)*le,m=Math.floor(d/1e3);f+=m,c-=1e3*m}p=1===l&&u(r)===r?new t(e.parse(r)):l>=7?new t(r,o,n,i,s,f,c):l>=6?new t(r,o,n,i,s,f):l>=5?new t(r,o,n,i,s):l>=4?new t(r,o,n,i):l>=3?new t(r,o,n):l>=2?new t(r,o):l>=1?new t(r instanceof t?+r:r):new t}else p=t.apply(this,arguments);return I(p)||R(p,{constructor:e},!0),p},r=new RegExp("^(\\d{4}|[+-]\\d{6})(?:-(\\d{2})(?:-(\\d{2})(?:T(\\d{2}):(\\d{2})(?::(\\d{2})(?:(\\.\\d{1,}))?)?(Z|(?:([-+])(\\d{2}):(\\d{2})))?)?)?)?$"),o=[0,31,59,90,120,151,181,212,243,273,304,334,365],n=function(t,e){var r=e>1?1:0;return o[e]+Math.floor((t-1969+r)/4)-Math.floor((t-1901+r)/100)+Math.floor((t-1601+r)/400)+365*(t-1970)};for(var i in t)j(t,i)&&(e[i]=t[i]);R(e,{now:t.now,UTC:t.UTC},!0),e.prototype=t.prototype,R(e.prototype,{constructor:e},!0);return R(e,{parse:function(e){var o=r.exec(e);if(o){var i,s=p(o[1]),a=p(o[2]||1)-1,u=p(o[3]||1)-1,h=p(o[4]||0),l=p(o[5]||0),f=p(o[6]||0),c=Math.floor(1e3*p(o[7]||0)),d=Boolean(o[4]&&!o[8]),m="-"===o[9]?1:-1,g=p(o[10]||0),v=p(o[11]||0);return h<(l>0||f>0||c>0?24:25)&&l<60&&f<60&&c<1e3&&a>-1&&a<12&&g<24&&v<60&&u>-1&&u<n(s,a+1)-n(s,a)&&(i=1e3*(60*((i=60*(24*(n(s,a)+u)+h+g*m))+l+v*m)+f)+c,d&&(i=function(e){var r=0,o=e;if(fe&&o>le){var n=Math.floor(o/le)*le,i=Math.floor(n/1e3);r+=i,o-=1e3*i}return p(new t(1970,0,1,0,0,r,o))}(i)),-864e13<=i&&i<=864e13)?i:NaN}return t.parse.apply(this,arguments)}}),e}(Date)}Date.now||(Date.now=function(){return(new Date).getTime()});var ce=l.toFixed&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0)),de={base:1e7,size:6,data:[0,0,0,0,0,0],multiply:function(t,e){for(var r=-1,o=e;++r<de.size;)o+=t*de.data[r],de.data[r]=o%de.base,o=Math.floor(o/de.base)},divide:function(t){for(var e=de.size,r=0;--e>=0;)r+=de.data[e],de.data[e]=Math.floor(r/t),r=r%t*de.base},numToString:function(){for(var t=de.size,e="";--t>=0;)if(""!==e||0===t||0!==de.data[t]){var r=u(de.data[t]);""===e?e=r:e+=J("0000000",0,7-r.length)+r}return e},pow:function t(e,r,o){return 0===r?o:r%2==1?t(e,r-1,o*e):t(e*e,r/2,o)},log:function(t){for(var e=0,r=t;r>=4096;)e+=12,r/=4096;for(;r>=2;)e+=1,r/=2;return e}};R(l,{toFixed:function(t){var e,r,o,n,i,s,a,h;if(e=p(t),(e=N(e)?0:Math.floor(e))<0||e>20)throw new RangeError("Number.toFixed called with invalid number of decimals");if(r=p(this),N(r))return"NaN";if(r<=-1e21||r>=1e21)return u(r);if(o="",r<0&&(o="-",r=-r),n="0",r>1e-21)if(s=(i=de.log(r*de.pow(2,69,1))-69)<0?r*de.pow(2,-i,1):r/de.pow(2,i,1),s*=4503599627370496,(i=52-i)>0){for(de.multiply(0,s),a=e;a>=7;)de.multiply(1e7,0),a-=7;for(de.multiply(de.pow(10,a,1),0),a=i-1;a>=23;)de.divide(1<<23),a-=23;de.divide(1<<a),de.multiply(1,1),de.divide(2),n=de.numToString()}else de.multiply(0,s),de.multiply(1<<-i,0),n=de.numToString()+J("0.00000000000000000000",2,2+e);return n=e>0?(h=n.length)<=e?o+J("0.0000000000000000000",0,e-h+2)+n:o+J(n,0,h-e)+"."+J(n,h-e):o+n}},ce);var me,ge,ve=function(){try{return"1"===1..toPrecision(void 0)}catch(t){return!0}}(),ye=l.toPrecision;R(l,{toPrecision:function(t){return void 0===t?ye.call(this):ye.call(this,t)}},ve),2!=="ab".split(/(?:ab)*/).length||4!==".".split(/(.?)(.?)/).length||"t"==="tesst".split(/(s)*/)[1]||4!=="test".split(/(?:)/,-1).length||"".split(/.?/).length||".".split(/()()/).length>1?(me=void 0===/()??/.exec("")[1],ge=Math.pow(2,32)-1,h.split=function(e,r){var o=String(this);if(void 0===e&&0===r)return[];if(!t(e))return Y(this,e,r);var n,i,s,a,u=[],h=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),p=0,l=new RegExp(e.source,h+"g");me||(n=new RegExp("^"+l.source+"$(?!\\s)",h));var f=void 0===r?ge:H(r);for(i=l.exec(o);i&&!((s=i.index+i[0].length)>p&&($(u,J(o,p,i.index)),!me&&i.length>1&&i[0].replace(n,(function(){for(var t=1;t<arguments.length-2;t++)void 0===arguments[t]&&(i[t]=void 0)})),i.length>1&&i.index<o.length&&d.apply(u,q(i,1)),a=i[0].length,p=s,u.length>=f));)l.lastIndex===i.index&&l.lastIndex++,i=l.exec(o);return p===o.length?!a&&l.test("")||$(u,""):$(u,J(o,p)),u.length>f?q(u,0,f):u}):"0".split(void 0,0).length&&(h.split=function(t,e){return void 0===t&&0===e?[]:Y(this,t,e)});var we,be=h.replace;(we=[],"x".replace(/x(.)?/g,(function(t,e){$(we,e)})),1===we.length&&void 0===we[0])||(h.replace=function(e,r){var o=A(r),n=t(e)&&/\)[*?]/.test(e.source);if(o&&n){return be.call(this,e,(function(t){var o=arguments.length,n=e.lastIndex;e.lastIndex=0;var i=e.exec(t)||[];return e.lastIndex=n,$(i,arguments[o-2],arguments[o-1]),r.apply(this,i)}))}return be.call(this,e,r)});var Ee=h.substr,Se="".substr&&"b"!=="0b".substr(-1);R(h,{substr:function(t,e){var r=t;return t<0&&(r=b(this.length+t,0)),Ee.call(this,r,e)}},Se);var Te="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff",xe="["+Te+"]",Oe=new RegExp("^"+xe+xe+"*"),Be=new RegExp(xe+xe+"*$"),Ae=h.trim&&(Te.trim()||!"​".trim());R(h,{trim:function(){if(null==this)throw new TypeError("can't convert "+this+" to object");return u(this).replace(Oe,"").replace(Be,"")}},Ae);var De=y.bind(String.prototype.trim),_e=h.lastIndexOf&&-1!=="abcあい".lastIndexOf("あい",2);R(h,{lastIndexOf:function(t){if(null==this)throw new TypeError("can't convert "+this+" to object");for(var e=u(this),r=u(t),o=arguments.length>1?p(arguments[1]):NaN,n=N(o)?1/0:G(o),i=E(b(n,0),e.length),s=r.length,a=i+s;a>0;){a=b(0,a-s);var h=Q(J(e,a,i+s),r);if(-1!==h)return a+h}return-1}},_e);var Ce,Me,Pe,Re=h.lastIndexOf;if(R(h,{lastIndexOf:function(t){return Re.apply(this,arguments)}},1!==h.lastIndexOf.length),8===parseInt(Te+"08")&&22===parseInt(Te+"0x16")||(parseInt=(Ce=parseInt,Me=/^[-+]?0[xX]/,function(t,e){var r=De(String(t)),o=p(e)||(Me.test(r)?16:10);return Ce(r,o)})),1/parseFloat("-0")!=-1/0&&(parseFloat=(Pe=parseFloat,function(t){var e=De(String(t)),r=Pe(e);return 0===r&&"-"===J(e,0,1)?-0:r})),"RangeError: test"!==String(new RangeError("test"))){Error.prototype.toString=function(){if(null==this)throw new TypeError("can't convert "+this+" to object");var t=this.name;void 0===t?t="Error":"string"!=typeof t&&(t=u(t));var e=this.message;return void 0===e?e="":"string"!=typeof e&&(e=u(e)),t?e?t+": "+e:t:e}}if(P){var Ie=function(t,e){if(X(t,e)){var r=Object.getOwnPropertyDescriptor(t,e);r.configurable&&(r.enumerable=!1,Object.defineProperty(t,e,r))}};Ie(Error.prototype,"message"),""!==Error.prototype.message&&(Error.prototype.message=""),Ie(Error.prototype,"name")}if("/a/gim"!==String(/a/gim)){RegExp.prototype.toString=function(){var t="/"+this.source+"/";return this.global&&(t+="g"),this.ignoreCase&&(t+="i"),this.multiline&&(t+="m"),t}}})),function(t){function e(t,e,r){var h,p,l,f,c,d,m,g,v,y=0,E=[],S=0,T=!1,x=[],O=[],B=!1;if(h=(r=r||{}).encoding||"UTF8",(v=r.numRounds||1)!==parseInt(v,10)||1>v)throw Error("numRounds must a integer >= 1");if(0!==t.lastIndexOf("SHA-",0))throw Error("Chosen SHA variant is not supported");if(d=function(e,r){return b(e,r,t)},m=function(e,r,o,n){var i,s;if("SHA-224"!==t&&"SHA-256"!==t)throw Error("Unexpected error in SHA-2 implementation");for(i=15+(r+65>>>9<<4),s=16;e.length<=i;)e.push(0);for(e[r>>>5]|=128<<24-r%32,r+=o,e[i]=4294967295&r,e[i-1]=r/4294967296|0,o=e.length,r=0;r<o;r+=s)n=b(e.slice(r,r+s),n,t);if("SHA-224"===t)e=[n[0],n[1],n[2],n[3],n[4],n[5],n[6]];else{if("SHA-256"!==t)throw Error("Unexpected error in SHA-2 implementation");e=n}return e},g=function(t){return t.slice()},"SHA-224"===t)c=512,f=224;else{if("SHA-256"!==t)throw Error("Chosen SHA variant is not supported");c=512,f=256}l=u(e,h),p=w(t),this.setHMACKey=function(e,r,o){var n;if(!0===T)throw Error("HMAC key already set");if(!0===B)throw Error("Cannot set HMAC key after calling update");if(e=(r=u(r,h=(o||{}).encoding||"UTF8")(e)).binLen,r=r.value,o=(n=c>>>3)/4-1,n<e/8){for(r=m(r,e,0,w(t));r.length<=o;)r.push(0);r[o]&=4294967040}else if(n>e/8){for(;r.length<=o;)r.push(0);r[o]&=4294967040}for(e=0;e<=o;e+=1)x[e]=909522486^r[e],O[e]=1549556828^r[e];p=d(x,p),y=c,T=!0},this.update=function(t){var e,r,o,n=0,i=c>>>5;for(t=(e=l(t,E,S)).binLen,r=e.value,e=t>>>5,o=0;o<e;o+=i)n+c<=t&&(p=d(r.slice(o,o+i),p),n+=c);y+=n,E=r.slice(n>>>5),S=t%c,B=!0},this.getHash=function(e,r){var u,h,l,c;if(!0===T)throw Error("Cannot call getHash after setting HMAC key");switch(l=a(r),e){case"HEX":u=function(t){return o(t,f,l)};break;case"B64":u=function(t){return n(t,f,l)};break;case"BYTES":u=function(t){return i(t,f)};break;case"ARRAYBUFFER":try{h=new ArrayBuffer(0)}catch(t){throw Error("ARRAYBUFFER not supported by this environment")}u=function(t){return s(t,f)};break;default:throw Error("format must be HEX, B64, BYTES, or ARRAYBUFFER")}for(c=m(E.slice(),S,y,g(p)),h=1;h<v;h+=1)c=m(c,f,0,w(t));return u(c)},this.getHMAC=function(e,r){var u,h,l,v;if(!1===T)throw Error("Cannot call getHMAC without first setting HMAC key");switch(l=a(r),e){case"HEX":u=function(t){return o(t,f,l)};break;case"B64":u=function(t){return n(t,f,l)};break;case"BYTES":u=function(t){return i(t,f)};break;case"ARRAYBUFFER":try{u=new ArrayBuffer(0)}catch(t){throw Error("ARRAYBUFFER not supported by this environment")}u=function(t){return s(t,f)};break;default:throw Error("outputFormat must be HEX, B64, BYTES, or ARRAYBUFFER")}return h=m(E.slice(),S,y,g(p)),v=d(O,w(t)),u(v=m(h,f,c,v))}}function r(){}function o(t,e,r){var o,n,i="";for(e/=8,o=0;o<e;o+=1)n=t[o>>>2]>>>8*(3+o%4*-1),i+="0123456789abcdef".charAt(n>>>4&15)+"0123456789abcdef".charAt(15&n);return r.outputUpper?i.toUpperCase():i}function n(t,e,r){var o,n,i,s="",a=e/8;for(o=0;o<a;o+=3)for(n=o+1<a?t[o+1>>>2]:0,i=o+2<a?t[o+2>>>2]:0,i=(t[o>>>2]>>>8*(3+o%4*-1)&255)<<16|(n>>>8*(3+(o+1)%4*-1)&255)<<8|i>>>8*(3+(o+2)%4*-1)&255,n=0;4>n;n+=1)s+=8*o+6*n<=e?"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(i>>>6*(3-n)&63):r.b64Pad;return s}function i(t,e){var r,o,n="",i=e/8;for(r=0;r<i;r+=1)o=t[r>>>2]>>>8*(3+r%4*-1)&255,n+=String.fromCharCode(o);return n}function s(t,e){var r,o,n=e/8,i=new ArrayBuffer(n);for(o=new Uint8Array(i),r=0;r<n;r+=1)o[r]=t[r>>>2]>>>8*(3+r%4*-1)&255;return i}function a(t){var e={outputUpper:!1,b64Pad:"=",shakeLen:-1};if(t=t||{},e.outputUpper=t.outputUpper||!1,!0===t.hasOwnProperty("b64Pad")&&(e.b64Pad=t.b64Pad),"boolean"!=typeof e.outputUpper)throw Error("Invalid outputUpper formatting option");if("string"!=typeof e.b64Pad)throw Error("Invalid b64Pad formatting option");return e}function u(t,e){var r;switch(e){case"UTF8":case"UTF16BE":case"UTF16LE":break;default:throw Error("encoding must be UTF8, UTF16BE, or UTF16LE")}switch(t){case"HEX":r=function(t,e,r){var o,n,i,s,a,u=t.length;if(0!=u%2)throw Error("String of HEX type must be in byte increments");for(e=e||[0],a=(r=r||0)>>>3,o=0;o<u;o+=2){if(n=parseInt(t.substr(o,2),16),isNaN(n))throw Error("String of HEX type contains invalid characters");for(i=(s=(o>>>1)+a)>>>2;e.length<=i;)e.push(0);e[i]|=n<<8*(3+s%4*-1)}return{value:e,binLen:4*u+r}};break;case"TEXT":r=function(t,r,o){var n,i,s,a,u,h,p,l,f=0;if(r=r||[0],u=(o=o||0)>>>3,"UTF8"===e)for(l=3,s=0;s<t.length;s+=1)for(i=[],128>(n=t.charCodeAt(s))?i.push(n):2048>n?(i.push(192|n>>>6),i.push(128|63&n)):55296>n||57344<=n?i.push(224|n>>>12,128|n>>>6&63,128|63&n):(s+=1,n=65536+((1023&n)<<10|1023&t.charCodeAt(s)),i.push(240|n>>>18,128|n>>>12&63,128|n>>>6&63,128|63&n)),a=0;a<i.length;a+=1){for(h=(p=f+u)>>>2;r.length<=h;)r.push(0);r[h]|=i[a]<<8*(l+p%4*-1),f+=1}else if("UTF16BE"===e||"UTF16LE"===e)for(l=2,i="UTF16LE"===e||"UTF16LE"!==e&&!1,s=0;s<t.length;s+=1){for(n=t.charCodeAt(s),!0===i&&(n=(a=255&n)<<8|n>>>8),h=(p=f+u)>>>2;r.length<=h;)r.push(0);r[h]|=n<<8*(l+p%4*-1),f+=2}return{value:r,binLen:8*f+o}};break;case"B64":r=function(t,e,r){var o,n,i,s,a,u,h,p=0;if(-1===t.search(/^[a-zA-Z0-9=+\/]+$/))throw Error("Invalid character in base-64 string");if(n=t.indexOf("="),t=t.replace(/\=/g,""),-1!==n&&n<t.length)throw Error("Invalid '=' found in base-64 string");for(e=e||[0],u=(r=r||0)>>>3,n=0;n<t.length;n+=4){for(a=t.substr(n,4),i=s=0;i<a.length;i+=1)s|=(o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a[i]))<<18-6*i;for(i=0;i<a.length-1;i+=1){for(o=(h=p+u)>>>2;e.length<=o;)e.push(0);e[o]|=(s>>>16-8*i&255)<<8*(3+h%4*-1),p+=1}}return{value:e,binLen:8*p+r}};break;case"BYTES":r=function(t,e,r){var o,n,i,s,a;for(e=e||[0],i=(r=r||0)>>>3,n=0;n<t.length;n+=1)o=t.charCodeAt(n),s=(a=n+i)>>>2,e.length<=s&&e.push(0),e[s]|=o<<8*(3+a%4*-1);return{value:e,binLen:8*t.length+r}};break;case"ARRAYBUFFER":try{r=new ArrayBuffer(0)}catch(t){throw Error("ARRAYBUFFER not supported by this environment")}r=function(t,e,r){var o,n,i,s,a;for(e=e||[0],n=(r=r||0)>>>3,a=new Uint8Array(t),o=0;o<t.byteLength;o+=1)i=(s=o+n)>>>2,e.length<=i&&e.push(0),e[i]|=a[o]<<8*(3+s%4*-1);return{value:e,binLen:8*t.byteLength+r}};break;default:throw Error("format must be HEX, TEXT, B64, BYTES, or ARRAYBUFFER")}return r}function h(t,e){return t>>>e|t<<32-e}function p(t,e,r){return t&e^~t&r}function l(t,e,r){return t&e^t&r^e&r}function f(t){return h(t,2)^h(t,13)^h(t,22)}function c(t){return h(t,6)^h(t,11)^h(t,25)}function d(t){return h(t,7)^h(t,18)^t>>>3}function m(t){return h(t,17)^h(t,19)^t>>>10}function g(t,e){var r=(65535&t)+(65535&e);return((t>>>16)+(e>>>16)+(r>>>16)&65535)<<16|65535&r}function v(t,e,r,o){var n=(65535&t)+(65535&e)+(65535&r)+(65535&o);return((t>>>16)+(e>>>16)+(r>>>16)+(o>>>16)+(n>>>16)&65535)<<16|65535&n}function y(t,e,r,o,n){var i=(65535&t)+(65535&e)+(65535&r)+(65535&o)+(65535&n);return((t>>>16)+(e>>>16)+(r>>>16)+(o>>>16)+(n>>>16)+(i>>>16)&65535)<<16|65535&i}function w(t){var e,o=[];if(0!==t.lastIndexOf("SHA-",0))throw Error("No SHA variants supported");switch(o=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428],e=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],t){case"SHA-224":break;case"SHA-256":o=e;break;case"SHA-384":case"SHA-512":o=[new r,new r,new r,new r,new r,new r,new r,new r];break;default:throw Error("Unknown SHA variant")}return o}function b(t,e,r){var o,n,i,s,a,u,h,w,b,S,T,x,O,B,A,D,_,C,M,P,R,I,N,G=[];if("SHA-224"!==r&&"SHA-256"!==r)throw Error("Unexpected error in SHA-2 implementation");for(S=64,x=1,I=Number,O=g,B=v,A=y,D=d,_=m,C=f,M=c,R=l,P=p,N=E,r=e[0],o=e[1],n=e[2],i=e[3],s=e[4],a=e[5],u=e[6],h=e[7],T=0;T<S;T+=1)16>T?(b=T*x,w=t.length<=b?0:t[b],b=t.length<=b+1?0:t[b+1],G[T]=new I(w,b)):G[T]=B(_(G[T-2]),G[T-7],D(G[T-15]),G[T-16]),w=A(h,M(s),P(s,a,u),N[T],G[T]),b=O(C(r),R(r,o,n)),h=u,u=a,a=s,s=O(i,w),i=n,n=o,o=r,r=O(w,b);return e[0]=O(r,e[0]),e[1]=O(o,e[1]),e[2]=O(n,e[2]),e[3]=O(i,e[3]),e[4]=O(s,e[4]),e[5]=O(a,e[5]),e[6]=O(u,e[6]),e[7]=O(h,e[7]),e}var E;E=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],"function"==typeof define&&define.amd?define((function(){return e})):"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(module.exports=e),exports=e):t.jsSHA=e}(this),function(){var t;function e(t,e,r){null!=t&&("number"==typeof t?this.fromNumber(t,e,r):null==e&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,e))}function r(){return new e(null)}var o="undefined"!=typeof navigator;o&&"Microsoft Internet Explorer"==navigator.appName?(e.prototype.am=function(t,e,r,o,n,i){for(var s=32767&e,a=e>>15;--i>=0;){var u=32767&this[t],h=this[t++]>>15,p=a*u+h*s;n=((u=s*u+((32767&p)<<15)+r[o]+(1073741823&n))>>>30)+(p>>>15)+a*h+(n>>>30),r[o++]=1073741823&u}return n},t=30):o&&"Netscape"!=navigator.appName?(e.prototype.am=function(t,e,r,o,n,i){for(;--i>=0;){var s=e*this[t++]+r[o]+n;n=Math.floor(s/67108864),r[o++]=67108863&s}return n},t=26):(e.prototype.am=function(t,e,r,o,n,i){for(var s=16383&e,a=e>>14;--i>=0;){var u=16383&this[t],h=this[t++]>>14,p=a*u+h*s;n=((u=s*u+((16383&p)<<14)+r[o]+n)>>28)+(p>>14)+a*h,r[o++]=268435455&u}return n},t=28),e.prototype.DB=t,e.prototype.DM=(1<<t)-1,e.prototype.DV=1<<t;e.prototype.FV=Math.pow(2,52),e.prototype.F1=52-t,e.prototype.F2=2*t-52;var n,i,s=new Array;for(n="0".charCodeAt(0),i=0;i<=9;++i)s[n++]=i;for(n="a".charCodeAt(0),i=10;i<36;++i)s[n++]=i;for(n="A".charCodeAt(0),i=10;i<36;++i)s[n++]=i;function a(t){return"0123456789abcdefghijklmnopqrstuvwxyz".charAt(t)}function u(t,e){var r=s[t.charCodeAt(e)];return null==r?-1:r}function h(t){var e=r();return e.fromInt(t),e}function p(t){var e,r=1;return 0!=(e=t>>>16)&&(t=e,r+=16),0!=(e=t>>8)&&(t=e,r+=8),0!=(e=t>>4)&&(t=e,r+=4),0!=(e=t>>2)&&(t=e,r+=2),0!=(e=t>>1)&&(t=e,r+=1),r}function l(t){this.m=t}function f(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function c(t,e){return t&e}function d(t,e){return t|e}function m(t,e){return t^e}function g(t,e){return t&~e}function v(t){if(0==t)return-1;var e=0;return 65535&t||(t>>=16,e+=16),255&t||(t>>=8,e+=8),15&t||(t>>=4,e+=4),3&t||(t>>=2,e+=2),1&t||++e,e}function y(t){for(var e=0;0!=t;)t&=t-1,++e;return e}function w(){}function b(t){return t}function E(t){this.r2=r(),this.q3=r(),e.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}l.prototype.convert=function(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t},l.prototype.revert=function(t){return t},l.prototype.reduce=function(t){t.divRemTo(this.m,null,t)},l.prototype.mulTo=function(t,e,r){t.multiplyTo(e,r),this.reduce(r)},l.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},f.prototype.convert=function(t){var o=r();return t.abs().dlShiftTo(this.m.t,o),o.divRemTo(this.m,null,o),t.s<0&&o.compareTo(e.ZERO)>0&&this.m.subTo(o,o),o},f.prototype.revert=function(t){var e=r();return t.copyTo(e),this.reduce(e),e},f.prototype.reduce=function(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=32767&t[e],o=r*this.mpl+((r*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(t[r=e+this.m.t]+=this.m.am(0,o,t,e,0,this.m.t);t[r]>=t.DV;)t[r]-=t.DV,t[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)},f.prototype.mulTo=function(t,e,r){t.multiplyTo(e,r),this.reduce(r)},f.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},e.prototype.copyTo=function(t){for(var e=this.t-1;e>=0;--e)t[e]=this[e];t.t=this.t,t.s=this.s},e.prototype.fromInt=function(t){this.t=1,this.s=t<0?-1:0,t>0?this[0]=t:t<-1?this[0]=t+this.DV:this.t=0},e.prototype.fromString=function(t,r){var o;if(16==r)o=4;else if(8==r)o=3;else if(256==r)o=8;else if(2==r)o=1;else if(32==r)o=5;else{if(4!=r)return void this.fromRadix(t,r);o=2}this.t=0,this.s=0;for(var n=t.length,i=!1,s=0;--n>=0;){var a=8==o?255&t[n]:u(t,n);a<0?"-"==t.charAt(n)&&(i=!0):(i=!1,0==s?this[this.t++]=a:s+o>this.DB?(this[this.t-1]|=(a&(1<<this.DB-s)-1)<<s,this[this.t++]=a>>this.DB-s):this[this.t-1]|=a<<s,(s+=o)>=this.DB&&(s-=this.DB))}8==o&&128&t[0]&&(this.s=-1,s>0&&(this[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),i&&e.ZERO.subTo(this,this)},e.prototype.clamp=function(){for(var t=this.s&this.DM;this.t>0&&this[this.t-1]==t;)--this.t},e.prototype.dlShiftTo=function(t,e){var r;for(r=this.t-1;r>=0;--r)e[r+t]=this[r];for(r=t-1;r>=0;--r)e[r]=0;e.t=this.t+t,e.s=this.s},e.prototype.drShiftTo=function(t,e){for(var r=t;r<this.t;++r)e[r-t]=this[r];e.t=Math.max(this.t-t,0),e.s=this.s},e.prototype.lShiftTo=function(t,e){var r,o=t%this.DB,n=this.DB-o,i=(1<<n)-1,s=Math.floor(t/this.DB),a=this.s<<o&this.DM;for(r=this.t-1;r>=0;--r)e[r+s+1]=this[r]>>n|a,a=(this[r]&i)<<o;for(r=s-1;r>=0;--r)e[r]=0;e[s]=a,e.t=this.t+s+1,e.s=this.s,e.clamp()},e.prototype.rShiftTo=function(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t)e.t=0;else{var o=t%this.DB,n=this.DB-o,i=(1<<o)-1;e[0]=this[r]>>o;for(var s=r+1;s<this.t;++s)e[s-r-1]|=(this[s]&i)<<n,e[s-r]=this[s]>>o;o>0&&(e[this.t-r-1]|=(this.s&i)<<n),e.t=this.t-r,e.clamp()}},e.prototype.subTo=function(t,e){for(var r=0,o=0,n=Math.min(t.t,this.t);r<n;)o+=this[r]-t[r],e[r++]=o&this.DM,o>>=this.DB;if(t.t<this.t){for(o-=t.s;r<this.t;)o+=this[r],e[r++]=o&this.DM,o>>=this.DB;o+=this.s}else{for(o+=this.s;r<t.t;)o-=t[r],e[r++]=o&this.DM,o>>=this.DB;o-=t.s}e.s=o<0?-1:0,o<-1?e[r++]=this.DV+o:o>0&&(e[r++]=o),e.t=r,e.clamp()},e.prototype.multiplyTo=function(t,r){var o=this.abs(),n=t.abs(),i=o.t;for(r.t=i+n.t;--i>=0;)r[i]=0;for(i=0;i<n.t;++i)r[i+o.t]=o.am(0,n[i],r,i,0,o.t);r.s=0,r.clamp(),this.s!=t.s&&e.ZERO.subTo(r,r)},e.prototype.squareTo=function(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t[r]=0;for(r=0;r<e.t-1;++r){var o=e.am(r,e[r],t,2*r,0,1);(t[r+e.t]+=e.am(r+1,2*e[r],t,2*r+1,o,e.t-r-1))>=e.DV&&(t[r+e.t]-=e.DV,t[r+e.t+1]=1)}t.t>0&&(t[t.t-1]+=e.am(r,e[r],t,2*r,0,1)),t.s=0,t.clamp()},e.prototype.divRemTo=function(t,o,n){var i=t.abs();if(!(i.t<=0)){var s=this.abs();if(s.t<i.t)return null!=o&&o.fromInt(0),void(null!=n&&this.copyTo(n));null==n&&(n=r());var a=r(),u=this.s,h=t.s,l=this.DB-p(i[i.t-1]);l>0?(i.lShiftTo(l,a),s.lShiftTo(l,n)):(i.copyTo(a),s.copyTo(n));var f=a.t,c=a[f-1];if(0!=c){var d=c*(1<<this.F1)+(f>1?a[f-2]>>this.F2:0),m=this.FV/d,g=(1<<this.F1)/d,v=1<<this.F2,y=n.t,w=y-f,b=null==o?r():o;for(a.dlShiftTo(w,b),n.compareTo(b)>=0&&(n[n.t++]=1,n.subTo(b,n)),e.ONE.dlShiftTo(f,b),b.subTo(a,a);a.t<f;)a[a.t++]=0;for(;--w>=0;){var E=n[--y]==c?this.DM:Math.floor(n[y]*m+(n[y-1]+v)*g);if((n[y]+=a.am(0,E,n,w,0,f))<E)for(a.dlShiftTo(w,b),n.subTo(b,n);n[y]<--E;)n.subTo(b,n)}null!=o&&(n.drShiftTo(f,o),u!=h&&e.ZERO.subTo(o,o)),n.t=f,n.clamp(),l>0&&n.rShiftTo(l,n),u<0&&e.ZERO.subTo(n,n)}}},e.prototype.invDigit=function(){if(this.t<1)return 0;var t=this[0];if(!(1&t))return 0;var e=3&t;return(e=(e=(e=(e=e*(2-(15&t)*e)&15)*(2-(255&t)*e)&255)*(2-((65535&t)*e&65535))&65535)*(2-t*e%this.DV)%this.DV)>0?this.DV-e:-e},e.prototype.isEven=function(){return 0==(this.t>0?1&this[0]:this.s)},e.prototype.exp=function(t,o){if(t>4294967295||t<1)return e.ONE;var n=r(),i=r(),s=o.convert(this),a=p(t)-1;for(s.copyTo(n);--a>=0;)if(o.sqrTo(n,i),(t&1<<a)>0)o.mulTo(i,s,n);else{var u=n;n=i,i=u}return o.revert(n)},e.prototype.toString=function(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(16==t)e=4;else if(8==t)e=3;else if(2==t)e=1;else if(32==t)e=5;else{if(4!=t)return this.toRadix(t);e=2}var r,o=(1<<e)-1,n=!1,i="",s=this.t,u=this.DB-s*this.DB%e;if(s-- >0)for(u<this.DB&&(r=this[s]>>u)>0&&(n=!0,i=a(r));s>=0;)u<e?(r=(this[s]&(1<<u)-1)<<e-u,r|=this[--s]>>(u+=this.DB-e)):(r=this[s]>>(u-=e)&o,u<=0&&(u+=this.DB,--s)),r>0&&(n=!0),n&&(i+=a(r));return n?i:"0"},e.prototype.negate=function(){var t=r();return e.ZERO.subTo(this,t),t},e.prototype.abs=function(){return this.s<0?this.negate():this},e.prototype.compareTo=function(t){var e=this.s-t.s;if(0!=e)return e;var r=this.t;if(0!=(e=r-t.t))return this.s<0?-e:e;for(;--r>=0;)if(0!=(e=this[r]-t[r]))return e;return 0},e.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+p(this[this.t-1]^this.s&this.DM)},e.prototype.mod=function(t){var o=r();return this.abs().divRemTo(t,null,o),this.s<0&&o.compareTo(e.ZERO)>0&&t.subTo(o,o),o},e.prototype.modPowInt=function(t,e){var r;return r=t<256||e.isEven()?new l(e):new f(e),this.exp(t,r)},e.ZERO=h(0),e.ONE=h(1),w.prototype.convert=b,w.prototype.revert=b,w.prototype.mulTo=function(t,e,r){t.multiplyTo(e,r)},w.prototype.sqrTo=function(t,e){t.squareTo(e)},E.prototype.convert=function(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=r();return t.copyTo(e),this.reduce(e),e},E.prototype.revert=function(t){return t},E.prototype.reduce=function(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)},E.prototype.mulTo=function(t,e,r){t.multiplyTo(e,r),this.reduce(r)},E.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)};var S,T,x,O=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],B=(1<<26)/O[O.length-1];function A(){var t;t=(new Date).getTime(),T[x++]^=255&t,T[x++]^=t>>8&255,T[x++]^=t>>16&255,T[x++]^=t>>24&255,x>=N&&(x-=N)}if(e.prototype.chunkSize=function(t){return Math.floor(Math.LN2*this.DB/Math.log(t))},e.prototype.toRadix=function(t){if(null==t&&(t=10),0==this.signum()||t<2||t>36)return"0";var e=this.chunkSize(t),o=Math.pow(t,e),n=h(o),i=r(),s=r(),a="";for(this.divRemTo(n,i,s);i.signum()>0;)a=(o+s.intValue()).toString(t).substr(1)+a,i.divRemTo(n,i,s);return s.intValue().toString(t)+a},e.prototype.fromRadix=function(t,r){this.fromInt(0),null==r&&(r=10);for(var o=this.chunkSize(r),n=Math.pow(r,o),i=!1,s=0,a=0,h=0;h<t.length;++h){var p=u(t,h);p<0?"-"==t.charAt(h)&&0==this.signum()&&(i=!0):(a=r*a+p,++s>=o&&(this.dMultiply(n),this.dAddOffset(a,0),s=0,a=0))}s>0&&(this.dMultiply(Math.pow(r,s)),this.dAddOffset(a,0)),i&&e.ZERO.subTo(this,this)},e.prototype.fromNumber=function(t,r,o){if("number"==typeof r)if(t<2)this.fromInt(1);else for(this.fromNumber(t,o),this.testBit(t-1)||this.bitwiseTo(e.ONE.shiftLeft(t-1),d,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(r);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(e.ONE.shiftLeft(t-1),this);else{var n=new Array,i=7&t;n.length=1+(t>>3),r.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}},e.prototype.bitwiseTo=function(t,e,r){var o,n,i=Math.min(t.t,this.t);for(o=0;o<i;++o)r[o]=e(this[o],t[o]);if(t.t<this.t){for(n=t.s&this.DM,o=i;o<this.t;++o)r[o]=e(this[o],n);r.t=this.t}else{for(n=this.s&this.DM,o=i;o<t.t;++o)r[o]=e(n,t[o]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()},e.prototype.changeBit=function(t,r){var o=e.ONE.shiftLeft(t);return this.bitwiseTo(o,r,o),o},e.prototype.addTo=function(t,e){for(var r=0,o=0,n=Math.min(t.t,this.t);r<n;)o+=this[r]+t[r],e[r++]=o&this.DM,o>>=this.DB;if(t.t<this.t){for(o+=t.s;r<this.t;)o+=this[r],e[r++]=o&this.DM,o>>=this.DB;o+=this.s}else{for(o+=this.s;r<t.t;)o+=t[r],e[r++]=o&this.DM,o>>=this.DB;o+=t.s}e.s=o<0?-1:0,o>0?e[r++]=o:o<-1&&(e[r++]=this.DV+o),e.t=r,e.clamp()},e.prototype.dMultiply=function(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()},e.prototype.dAddOffset=function(t,e){if(0!=t){for(;this.t<=e;)this[this.t++]=0;for(this[e]+=t;this[e]>=this.DV;)this[e]-=this.DV,++e>=this.t&&(this[this.t++]=0),++this[e]}},e.prototype.multiplyLowerTo=function(t,e,r){var o,n=Math.min(this.t+t.t,e);for(r.s=0,r.t=n;n>0;)r[--n]=0;for(o=r.t-this.t;n<o;++n)r[n+this.t]=this.am(0,t[n],r,n,0,this.t);for(o=Math.min(t.t,e);n<o;++n)this.am(0,t[n],r,n,0,e-n);r.clamp()},e.prototype.multiplyUpperTo=function(t,e,r){--e;var o=r.t=this.t+t.t-e;for(r.s=0;--o>=0;)r[o]=0;for(o=Math.max(e-this.t,0);o<t.t;++o)r[this.t+o-e]=this.am(e-o,t[o],r,0,0,this.t+o-e);r.clamp(),r.drShiftTo(1,r)},e.prototype.modInt=function(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(0==e)r=this[0]%t;else for(var o=this.t-1;o>=0;--o)r=(e*r+this[o])%t;return r},e.prototype.millerRabin=function(t){var o=this.subtract(e.ONE),n=o.getLowestSetBit();if(n<=0)return!1;var i=o.shiftRight(n);(t=t+1>>1)>O.length&&(t=O.length);for(var s=r(),a=0;a<t;++a){s.fromInt(O[Math.floor(Math.random()*O.length)]);var u=s.modPow(i,this);if(0!=u.compareTo(e.ONE)&&0!=u.compareTo(o)){for(var h=1;h++<n&&0!=u.compareTo(o);)if(0==(u=u.modPowInt(2,this)).compareTo(e.ONE))return!1;if(0!=u.compareTo(o))return!1}}return!0},e.prototype.clone=function(){var t=r();return this.copyTo(t),t},e.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},e.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},e.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},e.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},e.prototype.toByteArray=function(){var t=this.t,e=new Array;e[0]=this.s;var r,o=this.DB-t*this.DB%8,n=0;if(t-- >0)for(o<this.DB&&(r=this[t]>>o)!=(this.s&this.DM)>>o&&(e[n++]=r|this.s<<this.DB-o);t>=0;)o<8?(r=(this[t]&(1<<o)-1)<<8-o,r|=this[--t]>>(o+=this.DB-8)):(r=this[t]>>(o-=8)&255,o<=0&&(o+=this.DB,--t)),128&r&&(r|=-256),0==n&&(128&this.s)!=(128&r)&&++n,(n>0||r!=this.s)&&(e[n++]=r);return e},e.prototype.equals=function(t){return 0==this.compareTo(t)},e.prototype.min=function(t){return this.compareTo(t)<0?this:t},e.prototype.max=function(t){return this.compareTo(t)>0?this:t},e.prototype.and=function(t){var e=r();return this.bitwiseTo(t,c,e),e},e.prototype.or=function(t){var e=r();return this.bitwiseTo(t,d,e),e},e.prototype.xor=function(t){var e=r();return this.bitwiseTo(t,m,e),e},e.prototype.andNot=function(t){var e=r();return this.bitwiseTo(t,g,e),e},e.prototype.not=function(){for(var t=r(),e=0;e<this.t;++e)t[e]=this.DM&~this[e];return t.t=this.t,t.s=~this.s,t},e.prototype.shiftLeft=function(t){var e=r();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e},e.prototype.shiftRight=function(t){var e=r();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e},e.prototype.getLowestSetBit=function(){for(var t=0;t<this.t;++t)if(0!=this[t])return t*this.DB+v(this[t]);return this.s<0?this.t*this.DB:-1},e.prototype.bitCount=function(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=y(this[r]^e);return t},e.prototype.testBit=function(t){var e=Math.floor(t/this.DB);return e>=this.t?0!=this.s:!!(this[e]&1<<t%this.DB)},e.prototype.setBit=function(t){return this.changeBit(t,d)},e.prototype.clearBit=function(t){return this.changeBit(t,g)},e.prototype.flipBit=function(t){return this.changeBit(t,m)},e.prototype.add=function(t){var e=r();return this.addTo(t,e),e},e.prototype.subtract=function(t){var e=r();return this.subTo(t,e),e},e.prototype.multiply=function(t){var e=r();return this.multiplyTo(t,e),e},e.prototype.divide=function(t){var e=r();return this.divRemTo(t,e,null),e},e.prototype.remainder=function(t){var e=r();return this.divRemTo(t,null,e),e},e.prototype.divideAndRemainder=function(t){var e=r(),o=r();return this.divRemTo(t,e,o),new Array(e,o)},e.prototype.modPow=function(t,e){var o,n,i=t.bitLength(),s=h(1);if(i<=0)return s;o=i<18?1:i<48?3:i<144?4:i<768?5:6,n=i<8?new l(e):e.isEven()?new E(e):new f(e);var a=new Array,u=3,c=o-1,d=(1<<o)-1;if(a[1]=n.convert(this),o>1){var m=r();for(n.sqrTo(a[1],m);u<=d;)a[u]=r(),n.mulTo(m,a[u-2],a[u]),u+=2}var g,v,y=t.t-1,w=!0,b=r();for(i=p(t[y])-1;y>=0;){for(i>=c?g=t[y]>>i-c&d:(g=(t[y]&(1<<i+1)-1)<<c-i,y>0&&(g|=t[y-1]>>this.DB+i-c)),u=o;!(1&g);)g>>=1,--u;if((i-=u)<0&&(i+=this.DB,--y),w)a[g].copyTo(s),w=!1;else{for(;u>1;)n.sqrTo(s,b),n.sqrTo(b,s),u-=2;u>0?n.sqrTo(s,b):(v=s,s=b,b=v),n.mulTo(b,a[g],s)}for(;y>=0&&!(t[y]&1<<i);)n.sqrTo(s,b),v=s,s=b,b=v,--i<0&&(i=this.DB-1,--y)}return n.revert(s)},e.prototype.modInverse=function(t){var r=t.isEven();if(this.isEven()&&r||0==t.signum())return e.ZERO;for(var o=t.clone(),n=this.clone(),i=h(1),s=h(0),a=h(0),u=h(1);0!=o.signum();){for(;o.isEven();)o.rShiftTo(1,o),r?(i.isEven()&&s.isEven()||(i.addTo(this,i),s.subTo(t,s)),i.rShiftTo(1,i)):s.isEven()||s.subTo(t,s),s.rShiftTo(1,s);for(;n.isEven();)n.rShiftTo(1,n),r?(a.isEven()&&u.isEven()||(a.addTo(this,a),u.subTo(t,u)),a.rShiftTo(1,a)):u.isEven()||u.subTo(t,u),u.rShiftTo(1,u);o.compareTo(n)>=0?(o.subTo(n,o),r&&i.subTo(a,i),s.subTo(u,s)):(n.subTo(o,n),r&&a.subTo(i,a),u.subTo(s,u))}return 0!=n.compareTo(e.ONE)?e.ZERO:u.compareTo(t)>=0?u.subtract(t):u.signum()<0?(u.addTo(t,u),u.signum()<0?u.add(t):u):u},e.prototype.pow=function(t){return this.exp(t,new w)},e.prototype.gcd=function(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var o=e;e=r,r=o}var n=e.getLowestSetBit(),i=r.getLowestSetBit();if(i<0)return e;for(n<i&&(i=n),i>0&&(e.rShiftTo(i,e),r.rShiftTo(i,r));e.signum()>0;)(n=e.getLowestSetBit())>0&&e.rShiftTo(n,e),(n=r.getLowestSetBit())>0&&r.rShiftTo(n,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return i>0&&r.lShiftTo(i,r),r},e.prototype.isProbablePrime=function(t){var e,r=this.abs();if(1==r.t&&r[0]<=O[O.length-1]){for(e=0;e<O.length;++e)if(r[0]==O[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<O.length;){for(var o=O[e],n=e+1;n<O.length&&o<B;)o*=O[n++];for(o=r.modInt(o);e<n;)if(o%O[e++]==0)return!1}return r.millerRabin(t)},e.prototype.square=function(){var t=r();return this.squareTo(t),t},e.prototype.Barrett=E,null==T){var D;T=new Array,x=0;var _="undefined"!=typeof window?window.crypto||window.msCrypto:void 0;if(null!=_)if(_.getRandomValues){var C=new Uint8Array(32);for(_.getRandomValues(C),D=0;D<32;++D)T[x++]=C[D]}else if("Netscape"==navigator.appName&&navigator.appVersion<"5"){var M=_.random(32);for(D=0;D<M.length;++D)T[x++]=255&M.charCodeAt(D)}for(;x<N;)D=Math.floor(65536*Math.random()),T[x++]=D>>>8,T[x++]=255&D;x=0,A()}function P(){if(null==S){for(A(),(S=new I).init(T),x=0;x<T.length;++x)T[x]=0;x=0}return S.next()}function R(){}function I(){this.i=0,this.j=0,this.S=new Array}R.prototype.nextBytes=function(t){var e;for(e=0;e<t.length;++e)t[e]=P()},I.prototype.init=function(t){var e,r,o;for(e=0;e<256;++e)this.S[e]=e;for(r=0,e=0;e<256;++e)r=r+this.S[e]+t[e%t.length]&255,o=this.S[e],this.S[e]=this.S[r],this.S[r]=o;this.i=0,this.j=0},I.prototype.next=function(){var t;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,t=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=t,this.S[t+this.S[this.i]&255]};var N=256;"undefined"!=typeof exports?exports=module.exports={default:e,BigInteger:e,SecureRandom:R}:this.jsbn={BigInteger:e,SecureRandom:R}}.call(this),function(){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=new Array(-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1);function r(e){var r,o,n,i,s,a;for(n=e.length,o=0,r="";o<n;){if(i=255&e.charCodeAt(o++),o==n){r+=t.charAt(i>>2),r+=t.charAt((3&i)<<4),r+="==";break}if(s=e.charCodeAt(o++),o==n){r+=t.charAt(i>>2),r+=t.charAt((3&i)<<4|(240&s)>>4),r+=t.charAt((15&s)<<2),r+="=";break}a=e.charCodeAt(o++),r+=t.charAt(i>>2),r+=t.charAt((3&i)<<4|(240&s)>>4),r+=t.charAt((15&s)<<2|(192&a)>>6),r+=t.charAt(63&a)}return r}function o(t){var r,o,n,i,s,a,u;for(a=t.length,s=0,u="";s<a;){do{r=e[255&t.charCodeAt(s++)]}while(s<a&&-1==r);if(-1==r)break;do{o=e[255&t.charCodeAt(s++)]}while(s<a&&-1==o);if(-1==o)break;u+=String.fromCharCode(r<<2|(48&o)>>4);do{if(61==(n=255&t.charCodeAt(s++)))return u;n=e[n]}while(s<a&&-1==n);if(-1==n)break;u+=String.fromCharCode((15&o)<<4|(60&n)>>2);do{if(61==(i=255&t.charCodeAt(s++)))return u;i=e[i]}while(s<a&&-1==i);if(-1==i)break;u+=String.fromCharCode((3&n)<<6|i)}return u}"undefined"==typeof window||window.btoa?(btoa=r,atob=o):(window.btoa=r,window.atob=o)}(),"undefined"!=typeof window){var BigInteger=jsbn.BigInteger,SecureRandom=jsbn.SecureRandom;BigInteger.prototype.toJSON=function(){return this.toString(36)},BigInteger.ZERO.name="Zero",BigInteger.ONE.name="One"}var USE_FAKE_RANDOM=!1,SHOW_TRACES=!1,tracer=null,trace_clear=null,trace_remove=null;!function(){function t(t){var e=window[t];if(e&&("object"==typeof e&&"[object Window]"!=e.toString()))return e;return document.getElementById(t)}var e="";function r(r){if(null==t("trace")){var o=document.createElement("div");o.id="trace",document.body.appendChild(o),o.innerHTML='<input onclick="trace_clear()" type="button" value="Clear"><input onclick="trace_remove()" type="button" value="Remove"><br><textarea id="trace_text" cols="120" rows="25" spellcheck="false"></textarea>'}e+=r+"\n";var n=t("trace_text");n.value=e,n.scrollTop=n.scrollHeight}trace_clear=function(){e="",t("trace_text").value=e},trace_remove=function(){document.body.removeChild(t("trace"))};var o={};function n(t){o[t]||(o[t]=(new Date).getTime())}function i(t){if(o[t]){var e=(new Date).getTime();tracer.log("\ttiming for "+t+": "+(e-o[t]))}}function s(){}tracer=SHOW_TRACES?"object"==typeof document&&"object"!=typeof console?{log:function(t){r(t)},warn:function(t){r(t)},time:n,timeEnd:i}:{log:function(t){console.log(t)},warn:function(t){console.warn(t)},time:n,timeEnd:i}:{log:s,warn:s,time:s,timeEnd:s}}();var SHA={create:function(t,e,r){if("SHA-256"!=t)throw"Only SHA-256 is supported";var o=new jsSHA(t,e),n=r;return{hash:function(t){return o.update(t),o.getHash(n)}}}};function RandomizeUtils(){this._rnd=new SecureRandom,this._strongCrypto=!("undefined"==typeof window||!window.crypto&&!window.msCrypto),this._xorPool=null,this._poolIndex=0,this.setRandomPool=function(t){t&&(this._xorPool=t.map((function(t){return new BigInteger(t,16)})))},this.randomize_real=function(t,e){var r,o="number"==typeof t?new BigInteger(""+t):t,n=e||this._rnd,i=o.subtract(BigInteger.ONE).bitLength(),s=BigInteger.ZERO;!this._strongCrypto&&this._xorPool&&this._xorPool.length>0&&(s=this._xorPool[this._poolIndex++%this._xorPool.length].mod(t));do{r=(r=new BigInteger(i,n)).xor(s)}while(r.compareTo(o)>=0||r.equals(BigInteger.ZERO));return r},this.randomize=this.randomize_real}var randomizeUtils=new RandomizeUtils;function createObject(t){function e(){}return e.prototype=t,new e}function extend(t,e){var r=e.prototype;for(var o in e.prototype=createObject(t.prototype),r)e.prototype[o]=r[o]}function FPfast(){var t="undefined"!=typeof Float64Array?Float64Array:Array;this.ZERO=ArrayFill(new t(16),0),this.ONE=ArrayFill(new t(16),0),this.ONE[0]=1,this.TWO=ArrayFill(new t(16),0),this.TWO[0]=2;function e(t){var e,r,o=1;for(e=0;e<16;e++)r=t[e]+o+65535,o=Math.floor(r/65536),t[e]=r-65536*o;t[0]+=o-1+37*(o-1)}function r(t,e,r){for(var o,n=~(r-1),i=0;i<16;i++)o=n&(t[i]^e[i]),t[i]^=o,e[i]^=o}function o(o){e(o),e(o),e(o);for(var n,i=new t(16),s=0;s<2;s++){i[0]=o[0]-65517;for(var a=1;a<15;a++)i[a]=o[a]-65535-(i[a-1]>>16&1),i[a-1]&=65535;i[15]=o[15]-32767-(i[14]>>16&1),n=i[15]>>16&1,i[14]&=65535,r(o,i,1-n)}}function n(t,e,r){for(var o=0;o<16;o++)r[o]=t[o]+e[o];return r}function i(t,e,r){for(var o=0;o<16;o++)r[o]=t[o]-e[o];return r}function s(t,e){var r,o,n,i,s,a,u,h,p,l,f,c,d,m,g,v,y,w,b=t[0],E=t[1],S=t[2],T=t[3],x=t[4],O=t[5],B=t[6],A=t[7],D=t[8],_=t[9],C=t[10],M=t[11],P=t[12],R=t[13],I=t[14],N=t[15];return n=(r=(n=b*b+38*(2*(E*N+S*I+T*R+x*P+O*M+B*C+A*_)+D*D))+(o=1)+65535)-65536*(o=0|r/65536),i=(r=(i=2*b*E+2*(S*N+T*I+x*R+O*P+B*M+A*C+D*_)*38)+o+65535)-65536*(o=0|r/65536),s=(r=(s=b*S*2+E*E+38*(2*(T*N+x*I+O*R+B*P+A*M+D*C)+_*_))+o+65535)-65536*(o=0|r/65536),a=(r=(a=2*(b*T+E*S)+2*(x*N+O*I+B*R+A*P+D*M+_*C)*38)+o+65535)-65536*(o=0|r/65536),u=(r=(u=2*(b*x+E*T)+S*S+38*(2*(O*N+B*I+A*R+D*P+_*M)+C*C))+o+65535)-65536*(o=0|r/65536),h=(r=(h=2*(b*O+E*x+S*T)+2*(B*N+A*I+D*R+_*P+C*M)*38)+o+65535)-65536*(o=0|r/65536),p=(r=(p=2*(b*B+E*O+S*x)+T*T+38*(2*(A*N+D*I+_*R+C*P)+M*M))+o+65535)-65536*(o=0|r/65536),l=(r=(l=2*(b*A+E*B+S*O+T*x)+2*(D*N+_*I+C*R+M*P)*38)+o+65535)-65536*(o=0|r/65536),f=(r=(f=2*(b*D+E*A+S*B+T*O)+x*x+38*(2*(_*N+C*I+M*R)+P*P))+o+65535)-65536*(o=0|r/65536),c=(r=(c=2*(b*_+E*D+S*A+T*B+x*O)+2*(C*N+M*I+P*R)*38)+o+65535)-65536*(o=0|r/65536),d=(r=(d=2*(b*C+E*_+S*D+T*A+x*B)+O*O+38*(2*(M*N+P*I)+R*R))+o+65535)-65536*(o=0|r/65536),m=(r=(m=2*(b*M+E*C+S*_+T*D+x*A+O*B)+2*(P*N+R*I)*38)+o+65535)-65536*(o=0|r/65536),g=(r=(g=2*(b*P+E*M+S*C+T*_+x*D+O*A)+B*B+38*(R*N*2+I*I))+o+65535)-65536*(o=0|r/65536),v=(r=(v=2*(b*R+E*P+S*M+T*C+x*_+O*D+B*A)+I*N*2*38)+o+65535)-65536*(o=0|r/65536),y=(r=(y=2*(b*I+E*R+S*P+T*M+x*C+O*_+B*D)+A*A+N*N*38)+o+65535)-65536*(o=0|r/65536),w=(r=(w=2*(b*N+E*I+S*R+T*P+x*M+O*C+B*_+A*D))+o+65535)-65536*(o=0|r/65536),n=(r=(n+=38*(o-1))+(o=1)+65535)-65536*(o=0|r/65536),i=(r=i+o+65535)-65536*(o=0|r/65536),s=(r=s+o+65535)-65536*(o=0|r/65536),a=(r=a+o+65535)-65536*(o=0|r/65536),u=(r=u+o+65535)-65536*(o=0|r/65536),h=(r=h+o+65535)-65536*(o=0|r/65536),p=(r=p+o+65535)-65536*(o=0|r/65536),l=(r=l+o+65535)-65536*(o=0|r/65536),f=(r=f+o+65535)-65536*(o=0|r/65536),c=(r=c+o+65535)-65536*(o=0|r/65536),d=(r=d+o+65535)-65536*(o=0|r/65536),m=(r=m+o+65535)-65536*(o=0|r/65536),g=(r=g+o+65535)-65536*(o=0|r/65536),v=(r=v+o+65535)-65536*(o=0|r/65536),y=(r=y+o+65535)-65536*(o=0|r/65536),w=(r=w+o+65535)-65536*(o=0|r/65536),n+=38*(o-1),e[0]=n,e[1]=i,e[2]=s,e[3]=a,e[4]=u,e[5]=h,e[6]=p,e[7]=l,e[8]=f,e[9]=c,e[10]=d,e[11]=m,e[12]=g,e[13]=v,e[14]=y,e[15]=w,e}function a(t,e,r){var o,n,i,s,a,u,h,p,l,f,c,d,m,g,v,y,w,b,E=t[0],S=t[1],T=t[2],x=t[3],O=t[4],B=t[5],A=t[6],D=t[7],_=t[8],C=t[9],M=t[10],P=t[11],R=t[12],I=t[13],N=t[14],G=t[15],k=e[0],F=e[1],H=e[2],U=e[3],j=e[4],z=e[5],q=e[6],L=e[7],Z=e[8],V=e[9],J=e[10],Y=e[11],Q=e[12],$=e[13],X=e[14],W=e[15];return i=(o=(i=E*k+38*(S*W+M*q+P*z+R*j+I*U+N*H+G*F+T*X+x*$+O*Q+B*Y+A*J+D*V+_*Z+C*L))+(n=1)+65535)-65536*(n=0|o/65536),s=(o=(s=E*F+S*k+38*(M*L+P*q+R*z+I*j+N*U+G*H+T*W+x*X+O*$+B*Q+A*Y+D*J+_*V+C*Z))+n+65535)-65536*(n=0|o/65536),a=(o=(a=E*H+S*F+T*k+38*(M*Z+P*L+R*q+I*z+N*j+G*U+x*W+O*X+B*$+A*Q+D*Y+_*J+C*V))+n+65535)-65536*(n=0|o/65536),u=(o=(u=E*U+S*H+T*F+x*k+38*(M*V+P*Z+R*L+I*q+N*z+G*j+O*W+B*X+A*$+D*Q+_*Y+C*J))+n+65535)-65536*(n=0|o/65536),h=(o=(h=E*j+S*U+T*H+x*F+O*k+38*(M*J+P*V+R*Z+I*L+N*q+G*z+B*W+A*X+D*$+_*Q+C*Y))+n+65535)-65536*(n=0|o/65536),p=(o=(p=E*z+S*j+T*U+x*H+O*F+B*k+38*(M*Y+P*J+R*V+I*Z+N*L+G*q+A*W+D*X+_*$+C*Q))+n+65535)-65536*(n=0|o/65536),l=(o=(l=E*q+S*z+T*j+x*U+O*H+B*F+A*k+38*(M*Q+P*Y+R*J+I*V+N*Z+G*L+D*W+_*X+C*$))+n+65535)-65536*(n=0|o/65536),f=(o=(f=E*L+S*q+T*z+x*j+O*U+B*H+A*F+D*k+38*(M*$+P*Q+R*Y+I*J+N*V+G*Z+_*W+C*X))+n+65535)-65536*(n=0|o/65536),c=(o=(c=E*Z+S*L+T*q+x*z+O*j+B*U+A*H+D*F+_*k+38*(M*X+P*$+R*Q+I*Y+N*J+G*V+C*W))+n+65535)-65536*(n=0|o/65536),d=(o=(d=E*V+S*Z+T*L+x*q+O*z+B*j+A*U+D*H+_*F+C*k+38*(M*W+P*X+R*$+I*Q+N*Y+G*J))+n+65535)-65536*(n=0|o/65536),m=(o=(m=E*J+S*V+M*k+T*Z+x*L+O*q+B*z+A*j+D*U+_*H+C*F+38*(P*W+R*X+I*$+N*Q+G*Y))+n+65535)-65536*(n=0|o/65536),g=(o=(g=E*Y+S*J+M*F+P*k+T*V+x*Z+O*L+B*q+A*z+D*j+_*U+C*H+38*(R*W+I*X+N*$+G*Q))+n+65535)-65536*(n=0|o/65536),v=(o=(v=E*Q+S*Y+M*H+P*F+R*k+T*J+x*V+O*Z+B*L+A*q+D*z+_*j+C*U+38*(I*W+N*X+G*$))+n+65535)-65536*(n=0|o/65536),y=(o=(y=E*$+S*Q+M*U+P*H+R*F+I*k+T*Y+x*J+O*V+B*Z+A*L+D*q+_*z+C*j+38*(N*W+G*X))+n+65535)-65536*(n=0|o/65536),w=(o=(w=E*X+S*$+M*j+P*U+R*H+I*F+N*k+T*Q+x*Y+O*J+B*V+A*Z+D*L+_*q+C*z+G*W*38)+n+65535)-65536*(n=0|o/65536),b=(o=(b=E*W+S*X+M*z+P*j+R*U+I*H+N*F+G*k+T*$+x*Q+O*Y+B*J+A*V+D*Z+_*L+C*q)+n+65535)-65536*(n=0|o/65536),i=(o=(i+=38*(n-1))+(n=1)+65535)-65536*(n=0|o/65536),s=(o=s+n+65535)-65536*(n=0|o/65536),a=(o=a+n+65535)-65536*(n=0|o/65536),u=(o=u+n+65535)-65536*(n=0|o/65536),h=(o=h+n+65535)-65536*(n=0|o/65536),p=(o=p+n+65535)-65536*(n=0|o/65536),l=(o=l+n+65535)-65536*(n=0|o/65536),f=(o=f+n+65535)-65536*(n=0|o/65536),c=(o=c+n+65535)-65536*(n=0|o/65536),d=(o=d+n+65535)-65536*(n=0|o/65536),m=(o=m+n+65535)-65536*(n=0|o/65536),g=(o=g+n+65535)-65536*(n=0|o/65536),v=(o=v+n+65535)-65536*(n=0|o/65536),y=(o=y+n+65535)-65536*(n=0|o/65536),w=(o=w+n+65535)-65536*(n=0|o/65536),b=(o=b+n+65535)-65536*(n=0|o/65536),i+=38*(n-1),r[0]=i,r[1]=s,r[2]=a,r[3]=u,r[4]=h,r[5]=p,r[6]=l,r[7]=f,r[8]=c,r[9]=d,r[10]=m,r[11]=g,r[12]=v,r[13]=y,r[14]=w,r[15]=b,r}function u(t,e){for(var r=0;r<16;r++)e[r]=t[r];for(r=253;r>=0;r--)s(e,e),2!==r&&4!==r&&a(e,t,e);return e}function h(e){return u(e,new t(16))}function p(t,e){for(var r=0;r<16;r++)e[r]=-t[r];return e}function l(t,e,r){for(var o=!0,n=0;n<16;n++)if(0!=e[n]){o=!1;break}if(o)throw new Error("Dividing by Zero is bad");return a(t,h(e),r)}this.check=function(t){var e;for(e=0;e<16;e++)if(t[e]<0||t[e]>=65536)return!1;if(t[15]<32767)return!0;for(e=14;e>0;e--)if(t[e]<65535)return!0;return t[0]<65517},this.toHexString=function(t,e){var r="";e||o(t);for(var n=15;n>=0;n--){var i="000"+t[n].toString(16);r+=i.substr(i.length-4)}return r},this.toStringBase=function(t,e){var r=this.toHexString(t);return 16!==e&&(r=new BigInteger(r,16).toString(e)),r},this.fromHexString=function(e,r,o){var n="0000000000000000000000000000000000000000000000000000000000000000"+(16===(r||16)?e:new BigInteger(e,r).toString(16));n=n.substr(n.length-64);for(var i=new t(16),s=0;s<16;s++)i[15-s]=parseInt(n.substr(4*s,4),16);if(!o&&!this.check(i))throw new Error("This number is to large: "+e);return i},this.d=this.fromHexString("52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),this.p=this.fromHexString("7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed",null,!0),this.A=function(e,r){return n(e,r,new t(16))},this.Z=function(e,r){return i(e,r,new t(16))},this.N=function(e){return p(e,new t(16))},this.M=function(e,r){return a(e,r,new t(16))},this.S=function(e){return a(e,e,new t(16))},this.I=h,this.D=function(e,r){return l(e,r,new t(16))},this.E=function(t,e){o(t),o(e);for(var r=0;r<16;r++)if(t[r]!=e[r])return!1;return!0},this.isOne=function(t){for(var e=15;e>0;e--)if(0!=t[e])return!1;return 1==t[0]},this.A2=n,this.Z2=i,this.N2=p,this.M2=a,this.S2=s,this.I2=u,this.D2=l,this.baseclass=t}var fp=new FPfast;function Point(t,e){this.x=t,this.y=e}function PointExt(t,e,r,o,n){this.x=t,this.y=e,this.z=r,this.t=o,this.point=n}Point.prototype.buildFromCoords=function(t){return new Point(fp.fromHexString(t.x,36),fp.fromHexString(t.y,36))},PointExt.prototype.copy=function(){return new PointExt(this.x,this.y,this.z,this.t)},PointExt.prototype.toString=function(){return this.toPoint(),fp.toStringBase(this.point.x,10)+"-"+fp.toStringBase(this.point.y,10)},PointExt.prototype.compareTo=function(t){var e=this.toPoint(),r=t.toPoint();return fp.E(e.x,r.x)&&fp.E(e.y,r.y)?0:1},PointExt.prototype.toJSON=function(){return{x:this.x,y:this.y,z:this.z,t:this.t}},PointExt.prototype.toPoint=function(){if(!this.point){var t=fp.I(this.z);this.point=new Point(fp.M(t,this.x),fp.M(t,this.y))}return this.point},PointExt.prototype.multiply=function(t){var e,r=this.staticFp,o=r.A,n=r.B,i=r.C,s=r.D,a=r.E,u=r.F,h=r.G,p=r.H,l=r.tmp,f=fp,c=f.baseclass;for(e=0;e<16;e++)o[e]=this.y[e]-this.x[e],l[e]=t.y[e]-t.x[e];for(f.M2(o,l,o),e=0;e<16;e++)n[e]=this.y[e]+this.x[e],l[e]=t.y[e]+t.x[e];for(f.M2(n,l,n),f.M2(f.d,this.t,i),f.M2(i,t.t,i),e=0;e<16;e++)i[e]+=i[e];for(f.M2(this.z,t.z,s),e=0;e<16;e++)s[e]+=s[e],a[e]=n[e]-o[e],u[e]=s[e]-i[e],h[e]=s[e]+i[e],p[e]=n[e]+o[e];return new PointExt(f.M2(a,u,new c(16)),f.M2(h,p,new c(16)),f.M2(u,h,new c(16)),f.M2(a,p,new c(16)))},PointExt.prototype.square=function(){var t,e=this.staticFp,r=e.A,o=e.B,n=e.D,i=e.E,s=e.F,a=e.G,u=e.H,h=fp,p=h.baseclass;for(h.S2(this.x,r),h.S2(this.y,o),t=0;t<16;t++)n[t]=-r[t],i[t]=this.x[t]+this.y[t];for(h.S2(i,i),t=0;t<16;t++)i[t]-=r[t]+o[t],a[t]=n[t]+o[t],u[t]=n[t]-o[t];if(h.isOne(this.z)){var l=e.tmp;for(t=0;t<16;t++)l[t]=a[t]-h.TWO[t];return new PointExt(h.M2(i,l,new p(16)),h.M2(a,u,new p(16)),h.M2(a,l,new p(16)),h.M2(i,u,new p(16)))}var f=e.C;for(h.S2(this.z,f),t=0;t<16;t++)f[t]+=f[t],s[t]=a[t]-f[t];return new PointExt(h.M2(i,s,new p(16)),h.M2(a,u,new p(16)),h.M2(s,a,new p(16)),h.M2(i,u,new p(16)))},PointExt.prototype.invert=function(){return new PointExt(fp.N(this.x),this.y,this.z,fp.N(this.t))},PointExt.prototype.exponentiate=function(t){var e=new Array(this.expwindowmask+1);e[0]=this.ONE,e[1]=this;for(var r=2;r<=this.expwindowmask-1;r+=2)e[r]=e[r/2].square(),e[r+1]=e[r].multiply(this);var o=this.ONE;for(r=Math.ceil(t.bitLength()/this.expwindowsize)-1;r>=0;r-=1){var n=t.shiftRight(r*this.expwindowsize).and(this.expwindowmaskBn);if(o=o.multiply(e[n.byteValue()]),0!=r)for(var i=0;i<this.expwindowsize;i++)o=o.square()}return o},PointExt.prototype.staticFp={A:new fp.baseclass(16),B:new fp.baseclass(16),C:new fp.baseclass(16),D:new fp.baseclass(16),E:new fp.baseclass(16),F:new fp.baseclass(16),G:new fp.baseclass(16),H:new fp.baseclass(16),tmp:new fp.baseclass(16)},PointExt.prototype.buildFromPoint=function(t){return new PointExt(t.x,t.y,fp.ONE,fp.M(t.x,t.y),t)},PointExt.prototype.ONE=PointExt.prototype.buildFromPoint({x:fp.ZERO,y:fp.ONE}),PointExt.prototype.expwindowsize=4,PointExt.prototype.expwindowmask=(1<<PointExt.prototype.expwindowsize)-1,PointExt.prototype.expwindowmaskBn=new BigInteger(""+PointExt.prototype.expwindowmask);var OperandSerial=1;function Operand(t,e,r,o){this.serial=OperandSerial++,this._operation=void 0,this._operand1=void 0,this._operand2=void 0,this._value=void 0,this.resolutionQueue=null,null!=t&&null!=t?this._value=t:(this._operation=e,this._operand1=r,this._operand2=o||void 0)}function OperandBignum(t,e,r,o,n){Operand.call(this,t,r,o,n),this.name=e||null}function OperandString(t,e,r,o){Operand.call(this,t,e,r,o)}function GroupCyclic(t,e){this.modulo=new BigInteger(e.p,36),this.order=new BigInteger(e.q,36),this.neutral=this.newElement(this.buildValueFromObject(t,!0),"ONE"),this.generator=this.newElement(this.buildValueFromObject(e.g,!0),"G"),this.generatorInverse=this.generator.invert(!0),this.generatorInverse.name="1/G",this.Q=this.order,this.P=this.modulo,this.G=this.generator,this.invG=this.generatorInverse,this.one=this.neutral}function GroupElement(t,e,r,o,n,i){if(!t.constructor==GroupCyclic)throw new Error("Group element must be supplied with a valid group");Operand.call(this,e,o,n,i),this._group=t,this.name=r||null}function GroupBigIntMod(t){GroupCyclic.call(this,"1",t)}function GroupECC(t){GroupCyclic.call(this,{x:"0",y:"1"},{p:"not used",q:t.q,g:t.g})}function Proof(t,e){this.challenge=t,this.response=e,this.toString=function(){return"Proof [challenge="+t+", response="+e+"]"},this.copy=function(){return new Proof(this.challenge,this.response)}}function elGamalCipherSingle(t,e,r,o){return new CipherText(t.exponentiate(o),e.exponentiate(o).multiply(t.exponentiate(new BigInteger(r+""))),r,o)}function CipherText(t,e,r,o){this.alpha=t,this.beta=e,this.choice=r,this.random=o,this.proof=null,this.multiply=function(t){return new CipherText(this.alpha.multiply(t.alpha),this.beta.multiply(t.beta),this.choice+t.choice,this.random.add(t.random))},this.copy=function(){return new CipherText(this.alpha,this.beta,this.choice,this.random)},this.equals=function(t){return!!t&&(this==t||!(!this.alpha.equals(t.alpha)||!this.beta.equals(t.beta)))},this.toString=function(){return"CipherText [alpha="+this.alpha+", beta="+this.beta+", choice="+this.choice+", random="+this.random.toString(36)+"]"},this.toJSON=function(){return{alpha:this.alpha,beta:this.beta,choice:this.choice,proof:this.proof}}}function IndividualProofGenerator(t,e,r,o,n,i){var s=e.getGroup().invG,a={};a[o]=s.exponentiate(new BigInteger(""+o));for(var u=1;u<=n-o;u++)a[o+u]=a[o+u-1].multiply(s);this.iprove=function(e,r,o){var n=new OperandString("prove|"+i+"|");n=(n=(n=(n=n.concat(e.toString(!0))).concat(",")).concat(r.toString(!0))).concat("|");for(var s=0;s<o.length;s++)n=(n=(n=n.concat(o[s].A.toString(!0))).concat(",")).concat(o[s].B.toString(!0)),s!==o.length-1&&(n=n.concat(","));return n.sha256().mod(t)};var h=0;this.compute=function(i){var s=new Array(n-o+1),u=new Array(n-o+1),p=new OperandBignum(BigInteger.ZERO);h++;for(var l=o;l<=n;l++)if(l!=i.choice){var f=new OperandBignum(randomizeUtils.randomize(t),"iproof_rand_challenge_choice:"+h+"_value:"+l),c=new OperandBignum(randomizeUtils.randomize(t),"iproof_rand_response_choice:"+h+"_value:"+l);s[l-o]=new Proof(f,c),u[l-o]={A:e.exponentiate(c).divide(i.alpha.exponentiate(f)),B:r.exponentiate(c).divide(i.beta.multiply(a[l]).exponentiate(f))},p=p.add(f)}var d=new OperandBignum(randomizeUtils.randomize(t),"iproof_rand_w_choice:"+h);u[i.choice-o]={A:e.exponentiate(d),B:r.exponentiate(d)};f=this.iprove(i.alpha,i.beta,u).subtract(p).mod(t),c=d.add(i.random.multiply(f)).mod(t);s[i.choice-o]=new Proof(f,c),i.proof=s}}function Hproof(t,e,r,o,n){for(var i=new OperandString(e+"|"+r+"|"),s=0;s<o.length;s++)i=i.concat(o[s].toString(!0)),s!==o.length-1&&(i=i.concat(","));i=i.concat("|");for(s=0;s<n.length;s++)i=(i=(i=i.concat(n[s].A.toString(!0))).concat(",")).concat(n[s].B.toString(!0)),s!==n.length-1&&(i=i.concat(","));return i.sha256().mod(t)}function makeProofsPossiblyBlankProof(t,e,r,o,n,i){var s,a=t.Q,u=t.G,h=t.Y,p=[u,h,n.alpha,n.beta,i.alpha,i.beta],l=new Array(o-r+2);if(0==n.choice){var f=new OperandBignum(randomizeUtils.randomize(a),"oproof_rand_challenge1"),c=new OperandBignum(randomizeUtils.randomize(a),"oproof_rand_response1"),d={A:u.exponentiate(c).multiply(i.alpha.exponentiate(f)),B:h.exponentiate(c).multiply(i.beta.exponentiate(f))},m=new OperandBignum(randomizeUtils.randomize(a),"oproof_rand_w1");if(s=[new Proof(T=Hproof(a,"bproof0",e,p,[O={A:u.exponentiate(m),B:h.exponentiate(m)},d]).subtract(f).mod(a),x=m.subtract(n.random.multiply(T)).mod(a)),new Proof(f,c)],i.choice<r||i.choice>o)throw new Error("Bad number of set choices");var g=new Array(o-r+2);T=new OperandBignum(randomizeUtils.randomize(a),"oproof_rand_challenge0"),x=new OperandBignum(randomizeUtils.randomize(a),"oproof_rand_response0"),g[0]={A:u.exponentiate(x).multiply(n.alpha.exponentiate(T)),B:h.exponentiate(x).multiply(n.beta.divide(u).exponentiate(T))};var v=T;l[0]=new Proof(T,x);for(var y=1;y<o-r+2;y++)if(y!=i.choice-r+1){var w=new OperandBignum(randomizeUtils.randomize(a),"oproof_rand_challenge_"+y),b=new OperandBignum(randomizeUtils.randomize(a),"oproof_rand_response_"+y),E=i.beta.divide(u.exponentiate(new BigInteger(""+(r+y-1))));l[y]=new Proof(w,b),g[y]={A:u.exponentiate(b).multiply(i.alpha.exponentiate(w)),B:h.exponentiate(b).multiply(E.exponentiate(w))},v=v.add(w)}var S=new OperandBignum(randomizeUtils.randomize(a),"oproof_rand_w2");g[i.choice-r+1]={A:u.exponentiate(S),B:h.exponentiate(S)};w=Hproof(a,"bproof1",e,p,g).subtract(v).mod(a),b=S.subtract(i.random.multiply(w)).mod(a);l[i.choice-r+1]=new Proof(w,b)}else{if(0!=i.choice)throw new Error("cS.choice > 0 on a blank vote ?");var T=new OperandBignum(randomizeUtils.randomize(a),"oproof_rand_challenge0"),x=new OperandBignum(randomizeUtils.randomize(a),"oproof_rand_response0"),O={A:u.exponentiate(x).multiply(n.alpha.exponentiate(T)),B:h.exponentiate(x).multiply(n.beta.exponentiate(T))};m=new OperandBignum(randomizeUtils.randomize(a),"oproof_rand_w1"),f=Hproof(a,"bproof0",e,p,[O,d={A:u.exponentiate(m),B:h.exponentiate(m)}]).subtract(T).mod(a),c=m.subtract(i.random.multiply(f)).mod(a);s=[new Proof(T,x),new Proof(f,c)];for(g=new Array(o-r+2),v=new OperandBignum(BigInteger.ZERO),y=1;y<o-r+2;y++){w=new OperandBignum(randomizeUtils.randomize(a),"oproof_rand_challenge"),b=new OperandBignum(randomizeUtils.randomize(a),"oproof_rand_response"),E=i.beta.divide(u.exponentiate(new BigInteger(""+(r+y-1))));l[y]=new Proof(w,b),g[y]={A:u.exponentiate(b).multiply(i.alpha.exponentiate(w)),B:h.exponentiate(b).multiply(E.exponentiate(w))},v=v.add(w)}S=new OperandBignum(randomizeUtils.randomize(a),"oproof_rand_w2");g[0]={A:u.exponentiate(S),B:h.exponentiate(S)};w=Hproof(a,"bproof1",e,p,g).subtract(v).mod(a),b=S.subtract(n.random.multiply(w)).mod(a);l[0]=new Proof(w,b)}return{blankProofs:s,overallProofs:l}}function generateOtherProofs(t,e,r,o){o.length;var n=e.minSelection,i=e.maxSelection;if(e.blankAllowed){tracer.log("otherproofs with BLANK");var s,a=(s=o.slice(1).reduce((function(t,e){return t.multiply(e)}))).choice+o[0].choice;if(a.choice<n||a.choice>i)throw new Error("Bad number of set choices (min:"+n+", max:"+i+", got:"+a.choice+")");return makeProofsPossiblyBlankProof(t,r,n,i,o[0],s)}if(tracer.log("otherproofs no BLANK"),(s=o.reduce((function(t,e){return t.multiply(e)}))).choice<n||s.choice>i)throw new Error("Bad number of set choices (min:"+n+", max:"+i+", got:"+s.choice+")");return new IndividualProofGenerator(t.Q,t.G,t.Y,n,i,r).compute(s),{blankProofs:[],overallProofs:s.proof}}function GroupParameters(t,e){switch(t.type){case"ZpZ":case"Z/pZ":this.group=new GroupBigIntMod(t);break;case"ECC":case"ECC25519":this.group=new GroupECC(t);break;default:throw new Error("Missing group definition for "+t.type)}this.G=this.group.generator,this.Q=this.group.order,this.P=this.group.modulo,this.Y=this.group.newElement(this.group.buildValueFromObject(e,!0),"Y")}function Question(t,e){this.blankAllowed=e.isBlankAllowed,this.minSelection=e.minSelection,this.maxSelection=e.maxSelection,this.minmaxdiff=e.maxSelection-e.minSelection,this.text=t,this.poolsCiphered=[[],[]],this.choices=null,this.choicesNbOne=null,this.answersNb=e.nbElements,this.ciphered=[],this.answer={choices:null,othersProofs:null}}function Election(t,e,r,o,n){this.description=t,this.name=e,this.groupParameters=r,this.uuid=n,this.questions=[];for(var i=0;i<o.length;i++){var s=o[i];this.questions.push(new Question(s.text,s))}this.toJSON=function(){return{description:this.description,name:this.name,uuid:this.uuid}}}function Ballot(t,e){this.election=t;var r=e,o=this.election.uuid+r;this.finished=!1;var n=0,i=null;this.stats={tasksTotal:0,taskSkipped:0,resolve:0,toJSON:function(){return{tasksTotal:this.tasksTotal,taskSkipped:this.taskSkipped,resolve:this.resolve}}},OperandBignum.prototype.clearStats(),OperandString.prototype.clearStats(),GroupElement.prototype.clearStats();var s=this;navigator&&tracer.log("UserAgent: "+navigator.userAgent),window&&(tracer.log("window.crypto: "+(void 0!==window.crypto)),tracer.log("window.msCrypto: "+(void 0!==window.msCrypto)));var a=[];function u(t,e,r,o){s.stats.tasksTotal+=1,o?a.unshift({title:t,func:e,args:r}):a.push({title:t,func:e,args:r})}function h(t,e){e.isResolved()||u(t,s.resolveOperand,[e],!0)}this.listTasks=function(){return a.map((function(t){return t.title}))},this.processTask=function(){if(0!=a.length){var t=a.shift();t.func.apply(this,t.args),setTimeout((function(){s.processTask()}),10)}else setTimeout((function(){s.processTask()}),500)},this.computeBit=function(t,e,r){if(t.choicesNbOne){var o=0==e?t.answersNb-t.choicesNbOne:t.choicesNbOne;if(r+1>o)return this.stats.taskSkipped+=1,tracer.log("We already have enough "+e+"s (needed: "+o+"), skipping "+(r+1)+"th"),void(n-=8)}var i=this.election.groupParameters,s=new OperandBignum(randomizeUtils.randomize(i.Q)),a=elGamalCipherSingle(i.G,i.Y,e,s);t.poolsCiphered[e].push(a),u("Resolve ElGamal beta v="+e+", n="+r,this.resolveOperand,[a.beta],!0),u("Resolve ElGamal alpha v="+e+", n="+r,this.resolveOperand,[a.alpha],!0),this.individualProofGenerator.compute(a),h("Resolve iproof 1 response, v="+e+", n="+r,a.proof[1].response),h("Resolve iproof 1 challenge, v="+e+", n="+r,a.proof[1].challenge),h("Resolve iproof 0 response, v="+e+", n="+r,a.proof[0].response),h("Resolve iproof 0 challenge, v="+e+", n="+r,a.proof[0].challenge)},this.fillAnswers=function(t){tracer.timeEnd("compute bits");for(var e=0;e<t.answersNb;e++)t.ciphered.push(t.poolsCiphered[t.choices[e]].pop());t.answer.choices=t.ciphered.map((function(t){return{cipherText:{alpha:t.alpha,beta:t.beta},individualProofs:t.proof}})),t.poolsCiphered=[]},this.generateOtherProof=function(t){tracer.time("otherproof"),t.answer.othersProofs=generateOtherProofs(this.election.groupParameters,t,o,t.ciphered),t.ciphered=null;for(var e=t.answer.othersProofs.overallProofs,r=e.length-1;r>=0;r--)h("Resolve oproof overall "+r+" response",e[r].response),h("Resolve oproof overall "+r+" challenge",e[r].challenge);var n=t.answer.othersProofs.blankProofs;n.length>0&&(h("Resolve oproof blank 1 response",n[1].response),h("Resolve oproof blank 1 challenge",n[1].challenge),h("Resolve oproof blank 0 response",n[0].response),h("Resolve oproof blank 0 challenge",n[0].challenge))},this.finish=function(t){tracer.timeEnd("otherproof"),this.finished=!0},this.resolveOperand=function(t){if(this.stats.resolve+=1,t.resolutionQueue||t.buildResolutionQueue(),0!==t.resolutionQueue.length){var e=0,r=!1;do{var o=t.resolutionQueue.shift();r=o.isLong(),o.resolve(),e++}while(t.resolutionQueue.length>0&&!t.resolutionQueue[0].isLong()&&!r&&e<5);t.resolutionQueue.length>0&&u("Resolve... ("+t.resolutionQueue.length+" operations pending)",this.resolveOperand,[t],!0)}};var p=t.questions.length,l=t.groupParameters;this.individualProofGenerator=new IndividualProofGenerator(l.Q,l.G,l.Y,0,1,o),tracer.time("compute bits");for(var f=0;f<p;f++){for(var c=t.questions[f],d=0;d<c.answersNb-c.maxSelection;d++)u("Precompute mandatory bit 0 (q"+f+"/"+d+") ElGamal",this.computeBit,[c,0,d]);for(d=0;d<c.minSelection;d++)u("Precompute mandatory bit 1 (q"+f+"/"+d+") ElGamal",this.computeBit,[c,1,d]);for(d=0;d<c.minmaxdiff;d++){var m=c.answersNb-c.maxSelection+d,g=c.minSelection+d;u("Precompute optional bit 0 (q"+f+"/"+m+") ElGamal",this.computeBit,[c,0,m]),u("Precompute optional bit 1 (q"+f+"/"+g+") ElGamal",this.computeBit,[c,1,g])}if(c.blankAllowed)for(d=c.answersNb-c.minSelection;d<c.answersNb-1;d++)u("Precompute additional bit 0 (q"+f+"/"+d+") ElGamal",this.computeBit,[c,0,d])}for(f=0;f<p;f++){c=this.election.questions[f];n+=8*(c.answersNb+c.minmaxdiff),c.blankAllowed?n+=12+5*c.minmaxdiff:n+=2+4*c.minmaxdiff}tracer.log("Total number of exponentiate to do: "+n),this.processTask(),this.getProgress=function(){if(null===i)return 0;if(this.finished)return 1;var t=(GroupElement.prototype.stats.composeSelfN-i)/(n-i);return t<1?t:1},this.fill=function(t){if(t.length!=this.election.questions.length)throw new Error("Bad votes number, got "+t.length+" while election had "+p+" questions");for(var e=0;e<p;e++){var r=this.election.questions[e];if(r.choices=t[e],r.choicesNbOne=t[e].reduce((function(t,e){return t+e})),r.choices.length!==r.answersNb)throw new Error("Bad number of vote bits for question "+e+", got "+r.choices.length+" while question had "+r.answersNb+" options");if(r.blankAllowed&&1===r.choices[0]){if(1!==r.choicesNbOne)throw new Error("Blank bit is exclusive")}else if(r.choicesNbOne<r.minSelection||r.choicesNbOne>r.maxSelection)throw new Error("Bad number of set choices (min:"+r.minSelection+", max:"+r.maxSelection+", got:"+r.choicesNbOne+")");u("Fill answers with pre-computed bits",this.fillAnswers,[r]),u("Compute the overall proof",this.generateOtherProof,[r])}u("Finish",this.finish,[]),i=GroupElement.prototype.stats.composeSelfN},this.get=function(){for(var t={answers:[]},e=0;e<this.election.questions.length;e++)t.answers.push(this.election.questions[e].answer);return t.electionHash=SHA.create("SHA-256","TEXT","B64").hash(JSON.stringify(this.election)),t.electionUUID=this.election.uuid,t.tokenId=r,t}}function JsEncryptionEngine(){var t=this;t.ballot=null,this.init=function(e){var r=new GroupParameters(e.groupParameters,e.electionPublicKey);randomizeUtils.setRandomPool(e.bigIntegerRndPool);var o=new Election("Election's description","Election's name",r,e.questions,e.uuidString);t.ballot=new Ballot(o,e.tokenId)},this.setVote=function(e){t.ballot.fill(e)},this.startUserProgressBar=function(){},this.getUserProgression=function(e){return null===t.ballot?0:t.ballot.getProgress()},this.isFinished=function(){return!!t.ballot&&t.ballot.finished},this.getRemainingTime=function(){return t.ballot&&t.ballot.finished?0:10},this.getBallot=function(e){const r=JSON.stringify(t.ballot.get());return{ballot:r,secret:"##"+SHA.create("SHA-256","TEXT","HEX").hash(r+e)}},this.ballotTypeSwitch=function(){},this.getStatistics=function(){return{operandBignum:OperandBignum.prototype.stats,operandString:OperandString.prototype.stats,operandGroup:GroupElement.prototype.stats,ballot:t.ballot.stats}}}Operand.prototype.delayed=!0,Operand.prototype.clearStats=function(){throw new Error("No stats at Operand root level")},Operand.prototype.isResolved=function(){return void 0!==this._value},Operand.prototype.value=function(){if(void 0===this._value)throw new Error("this operation is not resolved yet");return this._value},Operand.prototype.toJSON=function(){if(void 0===this._value)throw new Error("this operation is not resolved yet");return this._value.toJSON()},Operand.prototype.resolve=function(){if(this.isResolved())throw new Error("this operation is already resolved");if(!this._operand1.isResolved())throw new Error("operand1 is not resolved yet");if(void 0!==this._operand2&&this._operand2.constructor===GroupElement&&!this._operand2.isResolved())throw new Error("operand2 is not resolved yet");var t=void 0,e=this._operand1,r=this._operand2;try{var o=void 0!==r?[r,!0]:[!0];t=this._operation.apply(e,o).value()}catch(t){throw new Error("error running "+this._operation.name+" operation available on operand "+e.toString()+": "+t)}return this._value=t,this._operation=this._operand1=this._operand2=void 0,this},Operand.prototype.buildResolutionQueue=function(){if(this.resolutionQueue=[],!this.isResolved()){for(var t=[this],e={};t.length>0;){var r=t.pop();function o(r){void 0===r||r.constructor!==Operand||r.isResolved()||e[r.serial]||(e[r.serial]=1,t.push(r))}this.resolutionQueue.push(r);for(var n=[r._operand1,r._operand2],i=0;i<n.length;i++)o(n[i])}return this.resolutionQueue.sort((function(t,e){return t.serial-e.serial})),this}},Operand.prototype.resolveFull=function(){return this.buildResolutionQueue(),this.resolutionQueue.forEach((function(t){t.resolve()})),this},Operand.prototype.isLong=function(){if(this.isResolved())throw new Error("this operation is already resolved");return!!this._operand1.isLongOperation&&this._operand1.isLongOperation(this._operation)},Operand.prototype.chooseDelay=function(t,e){var r=!this.isResolved()||e&&!e.isResolved();if(r&&t)throw new Error("Attempt to run immediate operation with unresolved operands");return!!(r||this.delayed&&!t)},extend(Operand,OperandBignum),OperandBignum.prototype.mod=function(t,e){return t.constructor===BigInteger&&(t=new OperandBignum(t)),this.chooseDelay(e,t)?new OperandBignum(null,null,OperandBignum.prototype.mod,this,t):(this.stats.mod+=1,new OperandBignum(this._value.mod(t.value())))},OperandBignum.prototype.add=function(t,e){return t.constructor===BigInteger&&(t=new OperandBignum(t)),this.chooseDelay(e,t)?new OperandBignum(null,null,OperandBignum.prototype.add,this,t):(this.stats.add+=1,new OperandBignum(this._value.add(t.value())))},OperandBignum.prototype.subtract=function(t,e){return t.constructor===BigInteger&&(t=new OperandBignum(t)),this.chooseDelay(e,t)?new OperandBignum(null,null,OperandBignum.prototype.subtract,this,t):(this.stats.subtract+=1,new OperandBignum(this._value.subtract(t.value())))},OperandBignum.prototype.multiply=function(t,e){return t.constructor===BigInteger&&(t=new OperandBignum(t)),this.chooseDelay(e,t)?new OperandBignum(null,null,OperandBignum.prototype.multiply,this,t):(this.stats.multiply+=1,new OperandBignum(this._value.multiply(t.value())))},OperandBignum.prototype.clearStats=function(){OperandBignum.prototype.stats={add:0,subtract:0,multiply:0,mod:0,toJSON:function(){return{add:this.add,subtract:this.subtract,multiply:this.multiply,mod:this.mod}}}},OperandBignum.prototype.clearStats(),extend(Operand,OperandString),OperandString.prototype.concat=function(t,e){return"string"==typeof t&&(t=new OperandString(t)),this.chooseDelay(e,t)?new OperandString(null,OperandString.prototype.concat,this,t):(this.stats.concat+=1,new OperandString(this._value+t._value))},OperandString.prototype.sha256=function(t){return this.chooseDelay(t)?new OperandBignum(null,null,OperandString.prototype.sha256,this):(this.stats.sha256+=1,new OperandBignum(new BigInteger(SHA.create("SHA-256","TEXT","HEX").hash(this._value),16)))},OperandString.prototype.clearStats=function(){OperandString.prototype.stats={sha256:0,concat:0,toJSON:function(){return{sha256:this.sha256,concat:this.concat}}}},OperandString.prototype.clearStats(),GroupCyclic.prototype.toString=function(){return"[group neutral: "+this.neutral.toString()+"]"},GroupCyclic.prototype.buildJSONelement=function(t){return t.toJSON()},GroupCyclic.prototype.buildValueFromObject=function(t,e){throw new Error("Called buildValueFromObject on an abstract group")},GroupCyclic.prototype.isMember=function(t){return 0==this.composeSelfN(t,this.order).compareTo(this.neutral._value)},GroupCyclic.prototype.compare=function(t,e){throw new Error("Called areEquals on an abstract group")},GroupCyclic.prototype.areEquals=function(t,e){return 0==this.compare(t,e)},GroupCyclic.prototype.compose=function(t,e){throw new Error("Called compose on an abstract group")},GroupCyclic.prototype.composeInvert=function(t,e){return this.compose(t,this.invert(e))},GroupCyclic.prototype.composeSelfN=function(t,e){if(0==e)return this.neutral;for(var r=t,o=1;o<e;o++)r=this.compose(r,t);return r},GroupCyclic.prototype.newElement=function(t,e){return new GroupElement(this,t,e)},GroupCyclic.prototype.invert=function(t){throw new Error("Called invert on an abstract group")},GroupCyclic.prototype.isLongOperation=function(t,e){return!1},extend(Operand,GroupElement),GroupElement.prototype.set=function(t){if(!this._group.isMember(t))throw new Error("Attempt to set a group element with a invalid value !");return this._value=t,this},GroupElement.prototype.toJSON=function(){return void 0!==this._value?this._group.buildJSONelement(this._value):"<unresolved operand>"},GroupElement.prototype.isNeutral=function(){return 0==this._group.compare(this._value,this._group.neutral)},GroupElement.prototype.getGroup=function(){return this._group},GroupElement.prototype.compareTo=function(t){if(t.getGroup()!=this._group)throw new Error("Attempt to compare elements from different groups !");return this._group.compare(this._value,t.value())},GroupElement.prototype.equals=function(t){if(t.getGroup()!=this._group)throw new Error("Attempt to compare elements from different groups !");return this._group.areEquals(this._value,t.value())},GroupElement.prototype.check=function(){return this._group.isMember(this._value)},GroupElement.prototype.toString=function(t,e){return this.chooseDelay(e)?new OperandString(null,GroupElement.prototype.toString,this,t):(this.stats.toString+=1,new OperandString(!t&&this.name||this._value.toString()))},GroupElement.prototype.compose=function(t,e){if(t.getGroup()!=this._group)throw new Error("Attempt to do group compose between elements of different groups !");return t===this._group.neutral?this:this.chooseDelay(e,t)?new GroupElement(this._group,null,null,GroupElement.prototype.compose,this,t):(this.stats.compose+=1,this._group.newElement(this._group.compose(this._value,t.value())))},GroupElement.prototype.composeInvert=function(t,e){if(t.getGroup()!=this._group)throw new Error("Attempt to do group compose between elements of different groups !");return t===this._group.neutral?this:this.chooseDelay(e,t)?new GroupElement(this._group,null,null,GroupElement.prototype.composeInvert,this,t):(this.stats.composeInvert+=1,this._group.newElement(this._group.composeInvert(this._value,t.value())))},GroupElement.prototype.composeSelfN=function(t,e){return t.constructor===BigInteger&&(t=new OperandBignum(t)),0==t.value().compareTo(BigInteger.ZERO)?this._group.neutral:0==t.value().compareTo(BigInteger.ONE)?this:this.chooseDelay(e,t)?new GroupElement(this._group,null,null,GroupElement.prototype.composeSelfN,this,t):(this.stats.composeSelfN+=1,this._group.newElement(this._group.composeSelfN(this._value,t.value())))},GroupElement.prototype.invert=function(t){return this.chooseDelay(t)?new GroupElement(this._group,null,null,GroupElement.prototype.invert,this):(this.stats.invert+=1,this._group.newElement(this._group.invert(this._value)))},GroupElement.prototype.isLongOperation=function(t){return this._group.isLongOperation(t,this._value)},GroupElement.prototype.multiply=GroupElement.prototype.compose,GroupElement.prototype.divide=GroupElement.prototype.composeInvert,GroupElement.prototype.exponentiate=GroupElement.prototype.composeSelfN,GroupElement.prototype.clearStats=function(){GroupElement.prototype.stats={compose:0,composeSelfN:0,composeInvert:0,invert:0,toString:0,toJSON:function(){return{compose:this.compose,composeSelfN:this.composeSelfN,composeInvert:this.composeInvert,invert:this.invert,toString:this.toString}}}},GroupElement.prototype.clearStats(),extend(GroupCyclic,GroupBigIntMod),GroupBigIntMod.prototype.buildValueFromObject=function(t){if("string"!=typeof t)throw new Error("Can't build a BigIntMod group element value from a "+typeof t);return new BigInteger(t,36)},GroupBigIntMod.prototype.isMember=function(t){return!0},GroupBigIntMod.prototype.compare=function(t,e){return t.compareTo(e)},GroupBigIntMod.prototype.compose=function(t,e){return t.multiply(e).mod(this.modulo)},GroupBigIntMod.prototype.composeSelfN=function(t,e){return t.modPow(e,this.modulo)},GroupBigIntMod.prototype.invert=function(t){return t.modInverse(this.modulo)},extend(GroupCyclic,GroupECC),GroupECC.prototype.buildJSONelement=function(t){var e=t.toPoint();return{x:fp.toStringBase(e.x,36),y:fp.toStringBase(e.y,36)}},GroupECC.prototype.buildValueFromObject=function(t,e){if("object"!=typeof t||"string"!=typeof t.x||"string"!=typeof t.y)throw new Error("Can't build an ECC group element value from a "+typeof t);var r=PointExt.prototype.buildFromPoint(Point.prototype.buildFromCoords(t));if(!e&&!this.isMember(r))throw new Error("This value is not a member of the group");return r},GroupECC.prototype.isMember=function(t){var e=fp.S(t.x),r=fp.S(t.y);return!!fp.E(fp.A(fp.Z(fp.A(fp.M(fp.d,e,r),e),r),fp.ONE),fp.ZERO)&&GroupCyclic.prototype.isMember.call(this,t)},GroupECC.prototype.compare=function(t,e){return t.isEqual(e)?0:1},GroupECC.prototype.compose=function(t,e){return t.multiply(e)},GroupECC.prototype.composeSelfN=function(t,e){return t.exponentiate(e)},GroupECC.prototype.invert=function(t){return t.invert()},GroupECC.prototype.isLongOperation=function(t,e){return"composeSelfN"===t||"toString"===t&&null===e.point},window.JsEncryptionEngine=JsEncryptionEngine;